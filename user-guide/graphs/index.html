<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="Sean Olson"><link href=https://plexus.rs/user-guide/graphs/ rel=canonical><link rel=icon href=../../img/favicon.ico><meta name=generator content="mkdocs-1.3.1, mkdocs-material-8.3.9"><title>Graphs - Plexus</title><link rel=stylesheet href=../../assets/stylesheets/main.1d29e8d0.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.cbb835fc.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=pink data-md-color-accent=light-blue> <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#representation class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title=Plexus class="md-header__button md-logo" aria-label=Plexus data-md-component=logo> <img src=../../img/plexus-minimal.svg alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Plexus </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Graphs </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=pink data-md-color-accent=light-blue aria-label=Light type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title=Light for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2a7 7 0 0 1 7 7c0 2.38-1.19 4.47-3 5.74V17a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-2.26C6.19 13.47 5 11.38 5 9a7 7 0 0 1 7-7M9 21v-1h6v1a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1m3-17a5 5 0 0 0-5 5c0 2.05 1.23 3.81 3 4.58V16h4v-2.42c1.77-.77 3-2.53 3-4.58a5 5 0 0 0-5-5Z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=pink data-md-color-accent=light-blue aria-label=Dark type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title=Dark for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2a7 7 0 0 0-7 7c0 2.38 1.19 4.47 3 5.74V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.26c1.81-1.27 3-3.36 3-5.74a7 7 0 0 0-7-7M9 21a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-1H9v1Z"/></svg> </label> </form> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/olson-sean-k/plexus title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> olson-sean-k/plexus </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title=Plexus class="md-nav__button md-logo" aria-label=Plexus data-md-component=logo> <img src=../../img/plexus-minimal.svg alt=logo> </a> Plexus </label> <div class=md-nav__source> <a href=https://github.com/olson-sean-k/plexus title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> olson-sean-k/plexus </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> Home </a> </li> <li class=md-nav__item> <a href=../../license/ class=md-nav__link> License </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3 type=checkbox id=__nav_3 checked> <label class=md-nav__link for=__nav_3> User Guide <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="User Guide" data-md-level=1> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> User Guide </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../getting-started/ class=md-nav__link> Getting Started </a> </li> <li class=md-nav__item> <a href=../geometry/ class=md-nav__link> Geometry </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> Graphs <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> Graphs </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#representation class=md-nav__link> Representation </a> </li> <li class=md-nav__item> <a href=#data-and-geometry class=md-nav__link> Data and Geometry </a> </li> <li class=md-nav__item> <a href=#views class=md-nav__link> Views </a> <nav class=md-nav aria-label=Views> <ul class=md-nav__list> <li class=md-nav__item> <a href=#interior-reborrows class=md-nav__link> Interior Reborrows </a> </li> <li class=md-nav__item> <a href=#rebinding class=md-nav__link> Rebinding </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#traversals class=md-nav__link> Traversals </a> <nav class=md-nav aria-label=Traversals> <ul class=md-nav__list> <li class=md-nav__item> <a href=#one-to-one class=md-nav__link> One-to-One </a> </li> <li class=md-nav__item> <a href=#one-to-many class=md-nav__link> One-to-Many </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#topological-mutations class=md-nav__link> Topological Mutations </a> </li> <li class=md-nav__item> <a href=#computation-vs-payload class=md-nav__link> Computation vs. Payload </a> </li> <li class=md-nav__item> <a href=#generic-programming class=md-nav__link> Generic Programming </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4 type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4> Contributor Guide <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Contributor Guide" data-md-level=1> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Contributor Guide </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../contributor-guide/tools-and-hosting/ class=md-nav__link> Tools and Hosting </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../rustdoc/plexus/index.html class=md-nav__link> API Documentation </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#representation class=md-nav__link> Representation </a> </li> <li class=md-nav__item> <a href=#data-and-geometry class=md-nav__link> Data and Geometry </a> </li> <li class=md-nav__item> <a href=#views class=md-nav__link> Views </a> <nav class=md-nav aria-label=Views> <ul class=md-nav__list> <li class=md-nav__item> <a href=#interior-reborrows class=md-nav__link> Interior Reborrows </a> </li> <li class=md-nav__item> <a href=#rebinding class=md-nav__link> Rebinding </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#traversals class=md-nav__link> Traversals </a> <nav class=md-nav aria-label=Traversals> <ul class=md-nav__list> <li class=md-nav__item> <a href=#one-to-one class=md-nav__link> One-to-One </a> </li> <li class=md-nav__item> <a href=#one-to-many class=md-nav__link> One-to-Many </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#topological-mutations class=md-nav__link> Topological Mutations </a> </li> <li class=md-nav__item> <a href=#computation-vs-payload class=md-nav__link> Computation vs. Payload </a> </li> <li class=md-nav__item> <a href=#generic-programming class=md-nav__link> Generic Programming </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1>Graphs</h1> <p>Plexus provides a flexible representation of meshes as a <a href=https://en.wikipedia.org/wiki/doubly_connected_edge_list>half-edge graph</a> via the <code>graph</code> module and <code>MeshGraph</code> type. Graphs can store arbitrary data associated with any topological structure. Unlike iterator expressions and buffers, graphs provide efficient traversals and complex manipulation of meshes.</p> <div class="admonition note"> <p class=admonition-title>Note</p> <p>Plexus refers to <em>half-edges</em> as <em>arcs</em>. This borrows from graph theory, where <em>arc</em> typically refers to a directed adjacency.</p> </div> <p><code>MeshGraph</code>s can be created in various ways, including from raw buffers, iterator expressions, incremental builders, and encodings.</p> <div class="tabbed-set tabbed-alternate" data-tabs=1:4><input checked=checked id=__tabbed_1_1 name=__tabbed_1 type=radio><input id=__tabbed_1_2 name=__tabbed_1 type=radio><input id=__tabbed_1_3 name=__tabbed_1 type=radio><input id=__tabbed_1_4 name=__tabbed_1 type=radio><div class=tabbed-labels><label for=__tabbed_1_1>Raw Buffers</label><label for=__tabbed_1_2>Iterator</label><label for=__tabbed_1_3>Builder</label><label for=__tabbed_1_4>PLY</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-1>1</a></span>
<span class=normal><a href=#__codelineno-0-2>2</a></span>
<span class=normal><a href=#__codelineno-0-3>3</a></span>
<span class=normal><a href=#__codelineno-0-4>4</a></span>
<span class=normal><a href=#__codelineno-0-5>5</a></span>
<span class=normal><a href=#__codelineno-0-6>6</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1></a><span class=c1>// Create a graph of a two-dimensional quadrilateral from raw buffers.</span>
<a id=__codelineno-0-2 name=__codelineno-0-2></a><span class=kd>let</span><span class=w> </span><span class=k>mut</span><span class=w> </span><span class=n>graph</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>MeshGraph</span>::<span class=o>&lt;</span><span class=n>Point2</span><span class=o>&lt;</span><span class=n>R64</span><span class=o>&gt;&gt;</span>::<span class=n>from_raw_buffers</span><span class=p>(</span><span class=w></span>
<a id=__codelineno-0-3 name=__codelineno-0-3></a><span class=w>    </span><span class=fm>vec!</span><span class=p>[</span><span class=n>Tetragon</span>::<span class=n>new</span><span class=p>(</span><span class=mi>0</span><span class=k>usize</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>,</span><span class=w> </span><span class=mi>3</span><span class=p>)],</span><span class=w></span>
<a id=__codelineno-0-4 name=__codelineno-0-4></a><span class=w>    </span><span class=fm>vec!</span><span class=p>[(</span><span class=mf>0.0</span><span class=p>,</span><span class=w> </span><span class=mf>0.0</span><span class=p>),</span><span class=w> </span><span class=p>(</span><span class=mf>1.0</span><span class=p>,</span><span class=w> </span><span class=mf>0.0</span><span class=p>),</span><span class=w> </span><span class=p>(</span><span class=mf>1.0</span><span class=p>,</span><span class=w> </span><span class=mf>1.0</span><span class=p>),</span><span class=w> </span><span class=p>(</span><span class=mf>0.0</span><span class=p>,</span><span class=w> </span><span class=mf>1.0</span><span class=p>)],</span><span class=w></span>
<a id=__codelineno-0-5 name=__codelineno-0-5></a><span class=p>)</span><span class=w></span>
<a id=__codelineno-0-6 name=__codelineno-0-6></a><span class=p>.</span><span class=n>unwrap</span><span class=p>();</span><span class=w></span>
</code></pre></div></td></tr></table></div> </div> <div class=tabbed-block> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-1-1>1</a></span>
<span class=normal><a href=#__codelineno-1-2>2</a></span>
<span class=normal><a href=#__codelineno-1-3>3</a></span>
<span class=normal><a href=#__codelineno-1-4>4</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-1-1 name=__codelineno-1-1></a><span class=c1>// Create a graph with positional data from a unit cube.</span>
<a id=__codelineno-1-2 name=__codelineno-1-2></a><span class=kd>let</span><span class=w> </span><span class=k>mut</span><span class=w> </span><span class=n>graph</span>: <span class=nc>MeshGraph</span><span class=o>&lt;</span><span class=n>Point3</span><span class=o>&lt;</span><span class=n>R64</span><span class=o>&gt;&gt;</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Cube</span>::<span class=n>new</span><span class=p>()</span><span class=w></span>
<a id=__codelineno-1-3 name=__codelineno-1-3></a><span class=w>    </span><span class=p>.</span><span class=n>polygons</span>::<span class=o>&lt;</span><span class=n>Position</span><span class=o>&lt;</span><span class=n>Point3</span><span class=o>&lt;</span><span class=n>R64</span><span class=o>&gt;&gt;&gt;</span><span class=p>()</span><span class=w></span>
<a id=__codelineno-1-4 name=__codelineno-1-4></a><span class=w>    </span><span class=p>.</span><span class=n>collect</span><span class=p>();</span><span class=w></span>
</code></pre></div></td></tr></table></div> </div> <div class=tabbed-block> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-2-1> 1</a></span>
<span class=normal><a href=#__codelineno-2-2> 2</a></span>
<span class=normal><a href=#__codelineno-2-3> 3</a></span>
<span class=normal><a href=#__codelineno-2-4> 4</a></span>
<span class=normal><a href=#__codelineno-2-5> 5</a></span>
<span class=normal><a href=#__codelineno-2-6> 6</a></span>
<span class=normal><a href=#__codelineno-2-7> 7</a></span>
<span class=normal><a href=#__codelineno-2-8> 8</a></span>
<span class=normal><a href=#__codelineno-2-9> 9</a></span>
<span class=normal><a href=#__codelineno-2-10>10</a></span>
<span class=normal><a href=#__codelineno-2-11>11</a></span>
<span class=normal><a href=#__codelineno-2-12>12</a></span>
<span class=normal><a href=#__codelineno-2-13>13</a></span>
<span class=normal><a href=#__codelineno-2-14>14</a></span>
<span class=normal><a href=#__codelineno-2-15>15</a></span>
<span class=normal><a href=#__codelineno-2-16>16</a></span>
<span class=normal><a href=#__codelineno-2-17>17</a></span>
<span class=normal><a href=#__codelineno-2-18>18</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-2-1 name=__codelineno-2-1></a><span class=k>fn</span> <span class=nf>trigon</span><span class=o>&lt;</span><span class=n>B</span><span class=p>,</span><span class=w> </span><span class=n>T</span><span class=o>&gt;</span><span class=p>(</span><span class=n>points</span>: <span class=p>[</span><span class=n>T</span><span class=p>;</span><span class=w> </span><span class=mi>3</span><span class=p>])</span><span class=w> </span>-&gt; <span class=nb>Result</span><span class=o>&lt;</span><span class=n>B</span><span class=p>,</span><span class=w> </span><span class=n>B</span>::<span class=n>Error</span><span class=o>&gt;</span><span class=w></span>
<a id=__codelineno-2-2 name=__codelineno-2-2></a><span class=k>where</span><span class=w></span>
<a id=__codelineno-2-3 name=__codelineno-2-3></a><span class=w>    </span><span class=n>B</span>: <span class=nc>Buildable</span><span class=p>,</span><span class=w></span>
<a id=__codelineno-2-4 name=__codelineno-2-4></a><span class=w>    </span><span class=n>B</span>::<span class=n>Vertex</span>: <span class=nc>FromGeometry</span><span class=o>&lt;</span><span class=n>T</span><span class=o>&gt;</span><span class=p>,</span><span class=w></span>
<a id=__codelineno-2-5 name=__codelineno-2-5></a><span class=p>{</span><span class=w></span>
<a id=__codelineno-2-6 name=__codelineno-2-6></a><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=k>mut</span><span class=w> </span><span class=n>builder</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>B</span>::<span class=n>builder</span><span class=p>();</span><span class=w></span>
<a id=__codelineno-2-7 name=__codelineno-2-7></a><span class=w>    </span><span class=n>builder</span><span class=p>.</span><span class=n>surface_with</span><span class=p>(</span><span class=o>|</span><span class=n>builder</span><span class=o>|</span><span class=w> </span><span class=p>{</span><span class=w></span>
<a id=__codelineno-2-8 name=__codelineno-2-8></a><span class=w>        </span><span class=kd>let</span><span class=w> </span><span class=p>[</span><span class=n>a</span><span class=p>,</span><span class=w> </span><span class=n>b</span><span class=p>,</span><span class=w> </span><span class=n>c</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>points</span><span class=p>;</span><span class=w></span>
<a id=__codelineno-2-9 name=__codelineno-2-9></a><span class=w>        </span><span class=kd>let</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>builder</span><span class=p>.</span><span class=n>insert_vertex</span><span class=p>(</span><span class=n>a</span><span class=p>)</span><span class=o>?</span><span class=p>;</span><span class=w></span>
<a id=__codelineno-2-10 name=__codelineno-2-10></a><span class=w>        </span><span class=kd>let</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>builder</span><span class=p>.</span><span class=n>insert_vertex</span><span class=p>(</span><span class=n>b</span><span class=p>)</span><span class=o>?</span><span class=p>;</span><span class=w></span>
<a id=__codelineno-2-11 name=__codelineno-2-11></a><span class=w>        </span><span class=kd>let</span><span class=w> </span><span class=n>c</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>builder</span><span class=p>.</span><span class=n>insert_vertex</span><span class=p>(</span><span class=n>c</span><span class=p>)</span><span class=o>?</span><span class=p>;</span><span class=w></span>
<a id=__codelineno-2-12 name=__codelineno-2-12></a><span class=w>        </span><span class=n>builder</span><span class=p>.</span><span class=n>facets_with</span><span class=p>(</span><span class=o>|</span><span class=n>builder</span><span class=o>|</span><span class=w> </span><span class=n>builder</span><span class=p>.</span><span class=n>insert_facet</span><span class=p>(</span><span class=o>&amp;</span><span class=p>[</span><span class=n>a</span><span class=p>,</span><span class=w> </span><span class=n>b</span><span class=p>,</span><span class=w> </span><span class=n>c</span><span class=p>],</span><span class=w> </span><span class=n>B</span>::<span class=n>Facet</span>::<span class=n>default</span><span class=p>()))</span><span class=w></span>
<a id=__codelineno-2-13 name=__codelineno-2-13></a><span class=w>    </span><span class=p>})</span><span class=o>?</span><span class=p>;</span><span class=w></span>
<a id=__codelineno-2-14 name=__codelineno-2-14></a><span class=w>    </span><span class=n>builder</span><span class=p>.</span><span class=n>build</span><span class=p>()</span><span class=w></span>
<a id=__codelineno-2-15 name=__codelineno-2-15></a><span class=p>}</span><span class=w></span>
<a id=__codelineno-2-16 name=__codelineno-2-16></a>
<a id=__codelineno-2-17 name=__codelineno-2-17></a><span class=c1>// Create a graph of a two-dimensional triangle.</span>
<a id=__codelineno-2-18 name=__codelineno-2-18></a><span class=kd>let</span><span class=w> </span><span class=n>graph</span>: <span class=nc>MeshGraph</span><span class=o>&lt;</span><span class=n>Point2</span><span class=o>&lt;</span><span class=kt>f64</span><span class=o>&gt;&gt;</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>trigon</span><span class=p>([(</span><span class=mf>0.0</span><span class=p>,</span><span class=w> </span><span class=mf>0.0</span><span class=p>),</span><span class=w> </span><span class=p>(</span><span class=mf>0.0</span><span class=p>,</span><span class=w> </span><span class=mf>1.0</span><span class=p>),</span><span class=w> </span><span class=p>(</span><span class=mf>1.0</span><span class=p>,</span><span class=w> </span><span class=mf>1.0</span><span class=p>)]).</span><span class=n>unwrap</span><span class=p>();</span><span class=w></span>
</code></pre></div></td></tr></table></div> </div> <div class=tabbed-block> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-3-1>1</a></span>
<span class=normal><a href=#__codelineno-3-2>2</a></span>
<span class=normal><a href=#__codelineno-3-3>3</a></span>
<span class=normal><a href=#__codelineno-3-4>4</a></span>
<span class=normal><a href=#__codelineno-3-5>5</a></span>
<span class=normal><a href=#__codelineno-3-6>6</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-3-1 name=__codelineno-3-1></a><span class=c1>// Create a graph from a PLY file.</span>
<a id=__codelineno-3-2 name=__codelineno-3-2></a><span class=kd>let</span><span class=w> </span><span class=p>(</span><span class=n>graph</span><span class=p>,</span><span class=w> </span><span class=n>_</span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>MeshGraph</span>::<span class=o>&lt;</span><span class=n>Point3</span><span class=o>&lt;</span><span class=n>R64</span><span class=o>&gt;&gt;</span>::<span class=n>from_ply</span><span class=p>(</span><span class=w></span>
<a id=__codelineno-3-3 name=__codelineno-3-3></a><span class=w>    </span><span class=n>PositionEncoding</span>::<span class=n>default</span><span class=p>(),</span><span class=w></span>
<a id=__codelineno-3-4 name=__codelineno-3-4></a><span class=w>    </span><span class=n>File</span>::<span class=n>open</span><span class=p>(</span><span class=s>&quot;teapot.ply&quot;</span><span class=p>).</span><span class=n>unwrap</span><span class=p>(),</span><span class=w></span>
<a id=__codelineno-3-5 name=__codelineno-3-5></a><span class=p>)</span><span class=w></span>
<a id=__codelineno-3-6 name=__codelineno-3-6></a><span class=p>.</span><span class=n>unwrap</span><span class=p>();</span><span class=w></span>
</code></pre></div></td></tr></table></div> </div> </div> </div> <h2 id=representation>Representation<a class=headerlink href=#representation title="Permanent link">&para;</a></h2> <p>A <code>MeshGraph</code> is composed of four basic entities: <em>vertices</em>, <em>arcs</em>, <em>edges</em>, and <em>faces</em>. The figure below summarizes the connectivity in a <code>MeshGraph</code>.</p> <p><img alt="Half-Edge Graph Figure" src=../../img/heg.svg></p> <p>Arcs are directed and connect vertices. An arc that is directed toward a vertex <span class=arithmatex><span class=MathJax_Preview>A</span><script type=math/tex>A</script></span> is an <em>incoming arc</em> with respect to <span class=arithmatex><span class=MathJax_Preview>A</span><script type=math/tex>A</script></span>. Similarly, an arc directed away from such a vertex is an <em>outgoing arc</em>. Every vertex is associated with exactly one <em>leading arc</em>, which is always an outgoing arc. The vertex toward which an arc is directed is the arc's <em>destination vertex</em> and the other is its <em>source vertex</em>.</p> <p>Every arc is paired with and connected to an <em>opposite arc</em> with an opposing direction. Given an arc from a vertex <span class=arithmatex><span class=MathJax_Preview>A</span><script type=math/tex>A</script></span> to a vertex <span class=arithmatex><span class=MathJax_Preview>B</span><script type=math/tex>B</script></span>, that arc will have an opposite arc from <span class=arithmatex><span class=MathJax_Preview>B</span><script type=math/tex>B</script></span> to <span class=arithmatex><span class=MathJax_Preview>A</span><script type=math/tex>A</script></span>. Such arcs are typically notated <span class=arithmatex><span class=MathJax_Preview>\overrightarrow{AB}</span><script type=math/tex>\overrightarrow{AB}</script></span> and <span class=arithmatex><span class=MathJax_Preview>\overrightarrow{BA}</span><script type=math/tex>\overrightarrow{BA}</script></span>. Together, these arcs form an <em>edge</em>, which is not directed. An edge and its two arcs are together called a <em>composite edge</em>.</p> <p>Arcs are connected to adjacent arcs, known as <em>next</em> and <em>previous arcs</em>. A traversal along a series of arcs is a <em>path</em>. The path formed by traversing from an arc to its next arc and so on is a <em>ring</em>. When a face is present within a ring, the arcs will refer to that face and the face will refer to exactly one of the arcs in the ring (its leading arc). An arc with no associated face is known as a <em>boundary arc</em>. If either of an edge's arcs is a boundary arc, then that edge is a <em>boundary edge</em>.</p> <p>A path is <em>closed</em> if it forms a loop and is <em>open</em> if it terminates. Rings implicitly form a loop and are therefore always closed. Paths may be notated using <em>sequence</em> or <em>set notation</em> and both forms are used to describe rings and faces.</p> <p>Sequence notation is formed from the ordered sequence of vertices that a path traverses, including the source vertex of the first arc and the destination vertex of the last arc. Set notation is similar, but is implicitly closed and only includes the ordered and unique set of vertices traversed by the path. An open path over vertices <span class=arithmatex><span class=MathJax_Preview>A</span><script type=math/tex>A</script></span>, <span class=arithmatex><span class=MathJax_Preview>B</span><script type=math/tex>B</script></span>, and <span class=arithmatex><span class=MathJax_Preview>C</span><script type=math/tex>C</script></span> is notated as a sequence <span class=arithmatex><span class=MathJax_Preview>\overrightarrow{(A,B,C)}</span><script type=math/tex>\overrightarrow{(A,B,C)}</script></span>. A closed path over vertices <span class=arithmatex><span class=MathJax_Preview>A</span><script type=math/tex>A</script></span>, <span class=arithmatex><span class=MathJax_Preview>B</span><script type=math/tex>B</script></span>, and <span class=arithmatex><span class=MathJax_Preview>C</span><script type=math/tex>C</script></span> includes the arc <span class=arithmatex><span class=MathJax_Preview>\overrightarrow{CA}</span><script type=math/tex>\overrightarrow{CA}</script></span> and is notated as a sequence <span class=arithmatex><span class=MathJax_Preview>\overrightarrow{(A,B,C,A)}</span><script type=math/tex>\overrightarrow{(A,B,C,A)}</script></span> or a set <span class=arithmatex><span class=MathJax_Preview>\overrightarrow{\{A,B,C\}}</span><script type=math/tex>\overrightarrow{\{A,B,C\}}</script></span>. This notation may also be used to notate arcs, but arcs typically use the shorthand notation shown above.</p> <p>Together with vertices and faces, the connectivity of arcs allows for efficient traversals of topology. For example, it becomes trivial to find adjacent topologies, such as the faces that share a given vertex or the adjacent faces of a given face.</p> <div class="admonition warning"> <p class=admonition-title>Warning</p> <p>The <code>MeshGraph</code> data structure has some limitations. With few exceptions, only <a href=https://en.wikipedia.org/wiki/orientability>orientable</a> compact <a href=https://en.wikipedia.org/wiki/surface_(topology)>manifolds</a> can be represented. Unorientable manifolds such as <a href=https://en.wikipedia.org/wiki/m%C3%B6bius_strip>MÃ¶bius strips</a> and non-manifold structures such as singularities and edge-fans cannot be modeled using <code>MeshGraph</code>.</p> </div> <p><code>MeshGraph</code>s store entities associatively and mesh data is accessed using keys into storage. Keys are exposed as strongly typed and opaque values, which can be used to refer to an entity.</p> <h2 id=data-and-geometry>Data and Geometry<a class=headerlink href=#data-and-geometry title="Permanent link">&para;</a></h2> <p><code>MeshGraph</code> accepts a single type parameter that determines the types of data associated with entities (vertices, arcs, edges, and faces) in the graph. This type must implement the <code>GraphData</code> trait, which provides an associated type for each entity.</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-4-1> 1</a></span>
<span class=normal><a href=#__codelineno-4-2> 2</a></span>
<span class=normal><a href=#__codelineno-4-3> 3</a></span>
<span class=normal><a href=#__codelineno-4-4> 4</a></span>
<span class=normal><a href=#__codelineno-4-5> 5</a></span>
<span class=normal><a href=#__codelineno-4-6> 6</a></span>
<span class=normal><a href=#__codelineno-4-7> 7</a></span>
<span class=normal><a href=#__codelineno-4-8> 8</a></span>
<span class=normal><a href=#__codelineno-4-9> 9</a></span>
<span class=normal><a href=#__codelineno-4-10>10</a></span>
<span class=normal><a href=#__codelineno-4-11>11</a></span>
<span class=normal><a href=#__codelineno-4-12>12</a></span>
<span class=normal><a href=#__codelineno-4-13>13</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-4-1 name=__codelineno-4-1></a><span class=k>pub</span><span class=w> </span><span class=k>struct</span> <span class=nc>Vertex</span><span class=w> </span><span class=p>{</span><span class=w></span>
<a id=__codelineno-4-2 name=__codelineno-4-2></a><span class=w>    </span><span class=k>pub</span><span class=w> </span><span class=n>position</span>: <span class=nc>Point3</span><span class=o>&lt;</span><span class=n>R64</span><span class=o>&gt;</span><span class=p>,</span><span class=w></span>
<a id=__codelineno-4-3 name=__codelineno-4-3></a><span class=w>    </span><span class=k>pub</span><span class=w> </span><span class=n>normal</span>: <span class=nc>Vector3</span><span class=o>&lt;</span><span class=n>R64</span><span class=o>&gt;</span><span class=p>,</span><span class=w></span>
<a id=__codelineno-4-4 name=__codelineno-4-4></a><span class=p>}</span><span class=w></span>
<a id=__codelineno-4-5 name=__codelineno-4-5></a>
<a id=__codelineno-4-6 name=__codelineno-4-6></a><span class=k>impl</span><span class=w> </span><span class=n>GraphData</span><span class=w> </span><span class=k>for</span><span class=w> </span><span class=n>Vertex</span><span class=w> </span><span class=p>{</span><span class=w></span>
<a id=__codelineno-4-7 name=__codelineno-4-7></a><span class=w>    </span><span class=k>type</span> <span class=nc>Vertex</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=bp>Self</span><span class=p>;</span><span class=w></span>
<a id=__codelineno-4-8 name=__codelineno-4-8></a><span class=w>    </span><span class=k>type</span> <span class=nc>Arc</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>();</span><span class=w></span>
<a id=__codelineno-4-9 name=__codelineno-4-9></a><span class=w>    </span><span class=k>type</span> <span class=nc>Edge</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>();</span><span class=w></span>
<a id=__codelineno-4-10 name=__codelineno-4-10></a><span class=w>    </span><span class=k>type</span> <span class=nc>Face</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>();</span><span class=w></span>
<a id=__codelineno-4-11 name=__codelineno-4-11></a><span class=p>}</span><span class=w></span>
<a id=__codelineno-4-12 name=__codelineno-4-12></a>
<a id=__codelineno-4-13 name=__codelineno-4-13></a><span class=kd>let</span><span class=w> </span><span class=k>mut</span><span class=w> </span><span class=n>graph</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>MeshGraph</span>::<span class=o>&lt;</span><span class=n>Vertex</span><span class=o>&gt;</span>::<span class=n>new</span><span class=p>();</span><span class=w></span>
</code></pre></div></td></tr></table></div> <div class="admonition note"> <p class=admonition-title>Note</p> <p>Most examples on this page use the <code>R64</code> type from the [<code>decorum</code>][] crate and the <code>Point2</code> and <code>Point3</code> types from the [<code>nalgebra</code>][] crate for graph data. When the <code>geometry-nalgebra</code> feature is enabled, these types implement <code>GraphData</code>.</p> </div> <p>The associated types specified by a <code>GraphData</code> implementation determine the type exposed by the <code>get</code> and <code>get_mut</code> functions of <a href=../graphs/#views>views</a>. <code>MeshGraph</code> is agnostic to its data and geometry and any types satisfying the bounds on <code>GraphData</code>'s associated types (namely <code>Copy</code> and <code>Default</code>) may be used, including the unit type <code>()</code> when no data is required. However, if the <code>Vertex</code> type exposes some notion of positional data via the <code>AsPosition</code> trait, then geometric features become available <code>MeshGraph</code> APIs. Read more about geometric traits and spatial operations <a href=../geometry>here</a>.</p> <h2 id=views>Views<a class=headerlink href=#views title="Permanent link">&para;</a></h2> <p><code>MeshGraph</code>s expose <em>views</em> over their entities (vertices, arcs, edges, and faces). Views are obtained using keys or iteration and provide the primary API for interacting with a <code>MeshGraph</code>'s topology and data. A view is a kind of "smart pointer" to an entity in a graph. There are three types of views summarized below:</p> <table> <thead> <tr> <th>Type</th> <th>Traversal</th> <th>Exclusive</th> <th>Geometry</th> <th>Topology</th> </tr> </thead> <tbody> <tr> <td>Immutable</td> <td>Yes</td> <td>No</td> <td>Immutable</td> <td>Immutable</td> </tr> <tr> <td>Mutable</td> <td>Yes</td> <td>Yes</td> <td>Mutable</td> <td>Mutable</td> </tr> <tr> <td>Orphan</td> <td>No</td> <td>No</td> <td>Mutable</td> <td>N/A</td> </tr> </tbody> </table> <p><em>Immutable</em> and <em>mutable views</em> behave similarly to Rust's <code>&amp;</code> and <code>&amp;mut</code> references: immutable views cannot mutate a graph and are not exclusive while mutable views may mutate both the data and topology of a graph but are exclusive. This example uses a view to traverse a graph:</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-5-1> 1</a></span>
<span class=normal><a href=#__codelineno-5-2> 2</a></span>
<span class=normal><a href=#__codelineno-5-3> 3</a></span>
<span class=normal><a href=#__codelineno-5-4> 4</a></span>
<span class=normal><a href=#__codelineno-5-5> 5</a></span>
<span class=normal><a href=#__codelineno-5-6> 6</a></span>
<span class=normal><a href=#__codelineno-5-7> 7</a></span>
<span class=normal><a href=#__codelineno-5-8> 8</a></span>
<span class=normal><a href=#__codelineno-5-9> 9</a></span>
<span class=normal><a href=#__codelineno-5-10>10</a></span>
<span class=normal><a href=#__codelineno-5-11>11</a></span>
<span class=normal><a href=#__codelineno-5-12>12</a></span>
<span class=normal><a href=#__codelineno-5-13>13</a></span>
<span class=normal><a href=#__codelineno-5-14>14</a></span>
<span class=normal><a href=#__codelineno-5-15>15</a></span>
<span class=normal><a href=#__codelineno-5-16>16</a></span>
<span class=normal><a href=#__codelineno-5-17>17</a></span>
<span class=normal><a href=#__codelineno-5-18>18</a></span>
<span class=normal><a href=#__codelineno-5-19>19</a></span>
<span class=normal><a href=#__codelineno-5-20>20</a></span>
<span class=normal><a href=#__codelineno-5-21>21</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-5-1 name=__codelineno-5-1></a><span class=k>type</span> <span class=nc>E3</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Point3</span><span class=o>&lt;</span><span class=n>R64</span><span class=o>&gt;</span><span class=p>;</span><span class=w></span>
<a id=__codelineno-5-2 name=__codelineno-5-2></a>
<a id=__codelineno-5-3 name=__codelineno-5-3></a><span class=c1>// Create a graph with positional and normal data from a unit cube.</span>
<a id=__codelineno-5-4 name=__codelineno-5-4></a><span class=kd>let</span><span class=w> </span><span class=n>cube</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Cube</span>::<span class=n>new</span><span class=p>();</span><span class=w></span>
<a id=__codelineno-5-5 name=__codelineno-5-5></a><span class=kd>let</span><span class=w> </span><span class=k>mut</span><span class=w> </span><span class=n>graph</span>: <span class=nc>MeshGraph</span><span class=o>&lt;</span><span class=n>Vertex</span><span class=o>&gt;</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>primitive</span>::<span class=n>zip_vertices</span><span class=p>((</span><span class=w></span>
<a id=__codelineno-5-6 name=__codelineno-5-6></a><span class=w>    </span><span class=n>cube</span><span class=p>.</span><span class=n>polygons</span>::<span class=o>&lt;</span><span class=n>Position</span><span class=o>&lt;</span><span class=n>E3</span><span class=o>&gt;&gt;</span><span class=p>(),</span><span class=w></span>
<a id=__codelineno-5-7 name=__codelineno-5-7></a><span class=w>    </span><span class=n>cube</span><span class=p>.</span><span class=n>polygons</span>::<span class=o>&lt;</span><span class=n>Normal</span><span class=o>&lt;</span><span class=n>E3</span><span class=o>&gt;&gt;</span><span class=p>(),</span><span class=w></span>
<a id=__codelineno-5-8 name=__codelineno-5-8></a><span class=p>))</span><span class=w></span>
<a id=__codelineno-5-9 name=__codelineno-5-9></a><span class=p>.</span><span class=n>map_vertices</span><span class=p>(</span><span class=o>|</span><span class=p>(</span><span class=n>position</span><span class=p>,</span><span class=w> </span><span class=n>normal</span><span class=p>)</span><span class=o>|</span><span class=w> </span><span class=n>Vertex</span>::<span class=n>new</span><span class=p>(</span><span class=n>position</span><span class=p>,</span><span class=w> </span><span class=n>normal</span><span class=p>))</span><span class=w></span>
<a id=__codelineno-5-10 name=__codelineno-5-10></a><span class=p>.</span><span class=n>collect</span><span class=p>();</span><span class=w></span>
<a id=__codelineno-5-11 name=__codelineno-5-11></a>
<a id=__codelineno-5-12 name=__codelineno-5-12></a><span class=c1>// Get a view of a face and its opposite face in the cube.</span>
<a id=__codelineno-5-13 name=__codelineno-5-13></a><span class=kd>let</span><span class=w> </span><span class=n>face</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>graph</span><span class=p>.</span><span class=n>faces</span><span class=p>().</span><span class=n>nth</span><span class=p>(</span><span class=mi>0</span><span class=p>).</span><span class=n>expect</span><span class=p>(</span><span class=s>&quot;cube&quot;</span><span class=p>);</span><span class=w></span>
<a id=__codelineno-5-14 name=__codelineno-5-14></a><span class=kd>let</span><span class=w> </span><span class=n>opposite</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>face</span><span class=w></span>
<a id=__codelineno-5-15 name=__codelineno-5-15></a><span class=w>    </span><span class=p>.</span><span class=n>into_arc</span><span class=p>()</span><span class=w></span>
<a id=__codelineno-5-16 name=__codelineno-5-16></a><span class=w>    </span><span class=p>.</span><span class=n>into_opposite_arc</span><span class=p>()</span><span class=w></span>
<a id=__codelineno-5-17 name=__codelineno-5-17></a><span class=w>    </span><span class=p>.</span><span class=n>into_next_arc</span><span class=p>()</span><span class=w></span>
<a id=__codelineno-5-18 name=__codelineno-5-18></a><span class=w>    </span><span class=p>.</span><span class=n>into_next_arc</span><span class=p>()</span><span class=w></span>
<a id=__codelineno-5-19 name=__codelineno-5-19></a><span class=w>    </span><span class=p>.</span><span class=n>into_opposite_arc</span><span class=p>()</span><span class=w></span>
<a id=__codelineno-5-20 name=__codelineno-5-20></a><span class=w>    </span><span class=p>.</span><span class=n>into_face</span><span class=p>()</span><span class=w></span>
<a id=__codelineno-5-21 name=__codelineno-5-21></a><span class=w>    </span><span class=p>.</span><span class=n>expect</span><span class=p>(</span><span class=s>&quot;cube&quot;</span><span class=p>);</span><span class=w></span>
</code></pre></div></td></tr></table></div> <p><em>Orphan views</em> are similar to mutable views in that they may mutate the data of a graph, but they do not have access to the topology of a graph. Because they do not know about other vertices, arcs, etc., orphan views cannot traverse a graph in any way. These views are most useful for modifying the data and geometry of a graph and, unlike mutable views, are not exclusive. As such, iterators over topological structures in a graph sometimes emit orphan views.</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-6-1> 1</a></span>
<span class=normal><a href=#__codelineno-6-2> 2</a></span>
<span class=normal><a href=#__codelineno-6-3> 3</a></span>
<span class=normal><a href=#__codelineno-6-4> 4</a></span>
<span class=normal><a href=#__codelineno-6-5> 5</a></span>
<span class=normal><a href=#__codelineno-6-6> 6</a></span>
<span class=normal><a href=#__codelineno-6-7> 7</a></span>
<span class=normal><a href=#__codelineno-6-8> 8</a></span>
<span class=normal><a href=#__codelineno-6-9> 9</a></span>
<span class=normal><a href=#__codelineno-6-10>10</a></span>
<span class=normal><a href=#__codelineno-6-11>11</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-6-1 name=__codelineno-6-1></a><span class=k>type</span> <span class=nc>E3</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Point3</span><span class=o>&lt;</span><span class=kt>f64</span><span class=o>&gt;</span><span class=p>;</span><span class=w></span>
<a id=__codelineno-6-2 name=__codelineno-6-2></a>
<a id=__codelineno-6-3 name=__codelineno-6-3></a><span class=c1>// Create a graph with positional data from a UV-sphere.</span>
<a id=__codelineno-6-4 name=__codelineno-6-4></a><span class=kd>let</span><span class=w> </span><span class=k>mut</span><span class=w> </span><span class=n>graph</span>: <span class=nc>MeshGraph</span><span class=o>&lt;</span><span class=n>E3</span><span class=o>&gt;</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>UvSphere</span>::<span class=n>new</span><span class=p>(</span><span class=mi>8</span><span class=p>,</span><span class=w> </span><span class=mi>8</span><span class=p>)</span><span class=w></span>
<a id=__codelineno-6-5 name=__codelineno-6-5></a><span class=w>    </span><span class=p>.</span><span class=n>polygons</span>::<span class=o>&lt;</span><span class=n>Position</span><span class=o>&lt;</span><span class=n>E3</span><span class=o>&gt;&gt;</span><span class=p>()</span><span class=w></span>
<a id=__codelineno-6-6 name=__codelineno-6-6></a><span class=w>    </span><span class=p>.</span><span class=n>collect_with_indexer</span><span class=p>(</span><span class=n>LruIndexer</span>::<span class=n>default</span><span class=p>());</span><span class=w></span>
<a id=__codelineno-6-7 name=__codelineno-6-7></a>
<a id=__codelineno-6-8 name=__codelineno-6-8></a><span class=c1>// Scale the position data in all vertices.</span>
<a id=__codelineno-6-9 name=__codelineno-6-9></a><span class=k>for</span><span class=w> </span><span class=k>mut</span><span class=w> </span><span class=n>vertex</span><span class=w> </span><span class=k>in</span><span class=w> </span><span class=n>graph</span><span class=p>.</span><span class=n>vertex_orphans</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w></span>
<a id=__codelineno-6-10 name=__codelineno-6-10></a><span class=w>    </span><span class=o>*</span><span class=n>vertex</span><span class=p>.</span><span class=n>get_mut</span><span class=p>()</span><span class=w> </span><span class=o>*=</span><span class=w> </span><span class=mf>2.0</span><span class=p>;</span><span class=w></span>
<a id=__codelineno-6-11 name=__codelineno-6-11></a><span class=p>}</span><span class=w></span>
</code></pre></div></td></tr></table></div> <p>Immutable and mutable views are both represented by view types, such as <code>FaceView</code>. Orphan views are represented by orphan view types, such as <code>FaceOrphan</code>.</p> <p>Views provide access to data in a graph via <code>get</code> and <code>get_mut</code> methods. These methods return references to the data described by the <code>GraphData</code> trait.</p> <h3 id=interior-reborrows>Interior Reborrows<a class=headerlink href=#interior-reborrows title="Permanent link">&para;</a></h3> <p>Views associate a key with a reference to storage in order to expose an entity. Because views maintain these references internally and behave like Rust references, they are typically manipulated by value rather than by reference (for example, in function parameters).</p> <p>To borrow views from another view, an <em>interior reborrow</em> is used, which reborrows a view's internal reference to storage containing a graph's entities. Immutable reborrows can be performed explicitly using the conversions described below:</p> <table> <thead> <tr> <th>Function</th> <th>Receiver</th> <th>Borrow</th> <th>Output</th> </tr> </thead> <tbody> <tr> <td><code>to_ref</code></td> <td><code>&amp;self</code></td> <td><code>&amp;_</code></td> <td>Immutable</td> </tr> <tr> <td><code>into_ref</code></td> <td><code>self</code></td> <td><code>&amp;*_</code></td> <td>Immutable</td> </tr> </tbody> </table> <p>It is not possible to explicitly perform a mutable interior reborrow. Such a reborrow could invalidate the originating view by performing topological mutations. Mutable reborrows are performed beneath safe APIs, such as those exposing iterators over orphan views that cannot perform topological mutations.</p> <div class="admonition warning"> <p class=admonition-title>Warning</p> <p>The <code>into_ref</code> conversion is analogous to an immutable reborrow of a mutable <code>&amp;mut</code> Rust reference. Importantly, the mutable source reference remains despite the reborrow and so it is not possible to obtain an additional mutable view after using <code>into_ref</code> until the originating view is dropped.</p> </div> <h3 id=rebinding>Rebinding<a class=headerlink href=#rebinding title="Permanent link">&para;</a></h3> <p>Views pair a key with a reference to the underlying storage of a graph. A view <em>binds</em> a key to some storage. Given a view, it is possible to <em>rebind</em> the view to construct a new view using the same underlying storage. It is even possible to rebind into different entities, such as rebinding a <code>FaceView</code> into a <code>VertexView</code>.</p> <p>For example, rebinding can be used for fallible traversals that maintain mutability. A mutable view can be used to look up a key and, if such a key is found, be rebound into that topology.</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-7-1> 1</a></span>
<span class=normal><a href=#__codelineno-7-2> 2</a></span>
<span class=normal><a href=#__codelineno-7-3> 3</a></span>
<span class=normal><a href=#__codelineno-7-4> 4</a></span>
<span class=normal><a href=#__codelineno-7-5> 5</a></span>
<span class=normal><a href=#__codelineno-7-6> 6</a></span>
<span class=normal><a href=#__codelineno-7-7> 7</a></span>
<span class=normal><a href=#__codelineno-7-8> 8</a></span>
<span class=normal><a href=#__codelineno-7-9> 9</a></span>
<span class=normal><a href=#__codelineno-7-10>10</a></span>
<span class=normal><a href=#__codelineno-7-11>11</a></span>
<span class=normal><a href=#__codelineno-7-12>12</a></span>
<span class=normal><a href=#__codelineno-7-13>13</a></span>
<span class=normal><a href=#__codelineno-7-14>14</a></span>
<span class=normal><a href=#__codelineno-7-15>15</a></span>
<span class=normal><a href=#__codelineno-7-16>16</a></span>
<span class=normal><a href=#__codelineno-7-17>17</a></span>
<span class=normal><a href=#__codelineno-7-18>18</a></span>
<span class=normal><a href=#__codelineno-7-19>19</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-7-1 name=__codelineno-7-1></a><span class=kd>let</span><span class=w> </span><span class=n>face</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>graph</span><span class=p>.</span><span class=n>face_mut</span><span class=p>(</span><span class=n>key</span><span class=p>).</span><span class=n>unwrap</span><span class=p>();</span><span class=w></span>
<a id=__codelineno-7-2 name=__codelineno-7-2></a><span class=c1>// Find a face along a boundary. If no such face is found, continue to use the</span>
<a id=__codelineno-7-3 name=__codelineno-7-3></a><span class=c1>// initiating face.</span>
<a id=__codelineno-7-4 name=__codelineno-7-4></a><span class=kd>let</span><span class=w> </span><span class=k>mut</span><span class=w> </span><span class=n>face</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>{</span><span class=w></span>
<a id=__codelineno-7-5 name=__codelineno-7-5></a><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>key</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>face</span><span class=w></span>
<a id=__codelineno-7-6 name=__codelineno-7-6></a><span class=w>        </span><span class=p>.</span><span class=n>traverse_by_depth</span><span class=p>()</span><span class=w></span>
<a id=__codelineno-7-7 name=__codelineno-7-7></a><span class=w>        </span><span class=p>.</span><span class=n>find</span><span class=p>(</span><span class=o>|</span><span class=n>face</span><span class=o>|</span><span class=w> </span><span class=p>{</span><span class=w></span>
<a id=__codelineno-7-8 name=__codelineno-7-8></a><span class=w>            </span><span class=n>face</span><span class=p>.</span><span class=n>adjacent_arcs</span><span class=p>()</span><span class=w></span>
<a id=__codelineno-7-9 name=__codelineno-7-9></a><span class=w>                </span><span class=p>.</span><span class=n>map</span><span class=p>(</span><span class=o>|</span><span class=n>arc</span><span class=o>|</span><span class=w> </span><span class=n>arc</span><span class=p>.</span><span class=n>into_opposite_arc</span><span class=p>())</span><span class=w></span>
<a id=__codelineno-7-10 name=__codelineno-7-10></a><span class=w>                </span><span class=p>.</span><span class=n>any</span><span class=p>(</span><span class=o>|</span><span class=n>arc</span><span class=o>|</span><span class=w> </span><span class=n>arc</span><span class=p>.</span><span class=n>is_boundary_arc</span><span class=p>())</span><span class=w></span>
<a id=__codelineno-7-11 name=__codelineno-7-11></a><span class=w>        </span><span class=p>})</span><span class=w></span>
<a id=__codelineno-7-12 name=__codelineno-7-12></a><span class=w>        </span><span class=p>.</span><span class=n>map</span><span class=p>(</span><span class=o>|</span><span class=n>face</span><span class=o>|</span><span class=w> </span><span class=n>face</span><span class=p>.</span><span class=n>key</span><span class=p>());</span><span class=w></span>
<a id=__codelineno-7-13 name=__codelineno-7-13></a><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=kd>let</span><span class=w> </span><span class=nb>Some</span><span class=p>(</span><span class=n>key</span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>key</span><span class=w> </span><span class=p>{</span><span class=w></span>
<a id=__codelineno-7-14 name=__codelineno-7-14></a><span class=w>        </span><span class=n>face</span><span class=p>.</span><span class=n>rebind</span><span class=p>(</span><span class=n>key</span><span class=p>).</span><span class=n>unwrap</span><span class=p>()</span><span class=w> </span><span class=c1>// Rebind into the boundary face.</span>
<a id=__codelineno-7-15 name=__codelineno-7-15></a><span class=w>    </span><span class=p>}</span><span class=w></span>
<a id=__codelineno-7-16 name=__codelineno-7-16></a><span class=w>    </span><span class=k>else</span><span class=w> </span><span class=p>{</span><span class=w></span>
<a id=__codelineno-7-17 name=__codelineno-7-17></a><span class=w>        </span><span class=n>face</span><span class=w> </span><span class=c1>// Use the initiating face.</span>
<a id=__codelineno-7-18 name=__codelineno-7-18></a><span class=w>    </span><span class=p>}</span><span class=w></span>
<a id=__codelineno-7-19 name=__codelineno-7-19></a><span class=p>};</span><span class=w></span>
</code></pre></div></td></tr></table></div> <p>Rebinding can also be useful for code that only operates on views without access to the associated <code>MeshGraph</code>, because it allows arbitrary access to the graph's structure so long as the appropriate keys are available.</p> <h2 id=traversals>Traversals<a class=headerlink href=#traversals title="Permanent link">&para;</a></h2> <p>Views can be used to traverse and search a graph's structure. Traversals are an important feature of graphs that are not supported by iterator expressions nor buffers. Most traversals involve some notion of adjacency, but <code>MeshGraph</code> also provides categorical traversals.</p> <h3 id=one-to-one>One-to-One<a class=headerlink href=#one-to-one title="Permanent link">&para;</a></h3> <p>Conversions and accessors provide one-to-one traversals from one entity to another. Conversions consume a view and emit another view while accessors borrow a view and use that borrow to produce another view. Accessors only expose immutable views with a limited lifetime while conversions expose views with the same lifetime and mutability as the source view.</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-8-1>1</a></span>
<span class=normal><a href=#__codelineno-8-2>2</a></span>
<span class=normal><a href=#__codelineno-8-3>3</a></span>
<span class=normal><a href=#__codelineno-8-4>4</a></span>
<span class=normal><a href=#__codelineno-8-5>5</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-8-1 name=__codelineno-8-1></a><span class=c1>// Get a mutable view of a vertex in a graph.</span>
<a id=__codelineno-8-2 name=__codelineno-8-2></a><span class=kd>let</span><span class=w> </span><span class=n>vertex</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>graph</span><span class=p>.</span><span class=n>vertex_mut</span><span class=p>(</span><span class=n>key</span><span class=p>).</span><span class=n>unwrap</span><span class=p>();</span><span class=w></span>
<a id=__codelineno-8-3 name=__codelineno-8-3></a>
<a id=__codelineno-8-4 name=__codelineno-8-4></a><span class=kd>let</span><span class=w> </span><span class=n>arc</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>vertex</span><span class=p>.</span><span class=n>into_outgoing_arc</span><span class=p>();</span><span class=w> </span><span class=c1>// Consumes `vertex`. `arc` is mutable.</span>
<a id=__codelineno-8-5 name=__codelineno-8-5></a><span class=kd>let</span><span class=w> </span><span class=n>opposite</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>arc</span><span class=p>.</span><span class=n>opposite_arc</span><span class=p>();</span><span class=w> </span><span class=c1>// Borrows `arc`. `opposite` is immutable.</span>
</code></pre></div></td></tr></table></div> <p>Conversions and accessors are distinguished using standard Rust naming conventions. For example, <code>into_outgoing_arc</code> is consuming and <code>outgoing_arc</code> is borrowing; both traverse from a vertex to its outgoing arc.</p> <p>Note that accessors are just sugar for performing an <a href=../graphs/#interior-reborrows>interior reborrow</a> before using a conversion. Accessors allow for more fluent sequences of function calls without the need to insert repeated <code>to_ref</code> calls.</p> <div class="admonition note"> <p class=admonition-title>Note</p> <p>It is not possible to perform <a href=../graphs/#topological-mutations>topological mutations</a> using a view obtained via a borrowing traversal, because these views are always <a href=../graphs/#views>immutable</a>. Conversions and interior reborrows must be used instead.</p> </div> <p>For some entities with a notion of adjacency, it is possible to query the shortest path between two such entities, such as vertices.</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-9-1>1</a></span>
<span class=normal><a href=#__codelineno-9-2>2</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-9-1 name=__codelineno-9-1></a><span class=c1>// Gets a `Path` from this vertex to the vertex with the given key.</span>
<a id=__codelineno-9-2 name=__codelineno-9-2></a><span class=kd>let</span><span class=w> </span><span class=n>path</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>vertex</span><span class=p>.</span><span class=n>into_shortest_path</span><span class=p>(</span><span class=n>key</span><span class=p>).</span><span class=n>unwrap</span><span class=p>();</span><span class=w></span>
</code></pre></div></td></tr></table></div> <p>It's also possible to use a custom metric. For example, rather than a logical distance between vertices, the Euclidean distance between vertices can be used.</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-10-1>1</a></span>
<span class=normal><a href=#__codelineno-10-2>2</a></span>
<span class=normal><a href=#__codelineno-10-3>3</a></span>
<span class=normal><a href=#__codelineno-10-4>4</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-10-1 name=__codelineno-10-1></a><span class=kd>let</span><span class=w> </span><span class=n>path</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>vertex</span><span class=p>.</span><span class=n>into_shortest_path_with</span><span class=p>(</span><span class=n>key</span><span class=p>,</span><span class=w> </span><span class=o>|</span><span class=n>from</span><span class=p>,</span><span class=w> </span><span class=n>to</span><span class=o>|</span><span class=w> </span><span class=p>{</span><span class=w></span>
<a id=__codelineno-10-2 name=__codelineno-10-2></a><span class=w>    </span><span class=c1>// Compute the Euclidean distance between the vertices `from` and `to`.</span>
<a id=__codelineno-10-3 name=__codelineno-10-3></a><span class=w>    </span><span class=p>(</span><span class=n>to</span><span class=p>.</span><span class=n>position</span><span class=p>()</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>from</span><span class=p>.</span><span class=n>position</span><span class=p>()).</span><span class=n>magnitude</span><span class=p>()</span><span class=w></span>
<a id=__codelineno-10-4 name=__codelineno-10-4></a><span class=p>}).</span><span class=n>unwrap</span><span class=p>();</span><span class=w></span>
</code></pre></div></td></tr></table></div> <h3 id=one-to-many>One-to-Many<a class=headerlink href=#one-to-many title="Permanent link">&para;</a></h3> <p>A <em>circulator</em> is a type of iterator that provides a one-to-many traversal that examines immediately adjacent entities. For example, the face circulator of a vertex yields all faces that share that vertex, in order.</p> <div class="admonition note"> <p class=admonition-title>Note</p> <p>Circlators only expose <strong>immediately</strong> adjacent entities and do not traverse the entire graph. Use search traversals to examine all entities in a topologically connected group.</p> </div> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-11-1>1</a></span>
<span class=normal><a href=#__codelineno-11-2>2</a></span>
<span class=normal><a href=#__codelineno-11-3>3</a></span>
<span class=normal><a href=#__codelineno-11-4>4</a></span>
<span class=normal><a href=#__codelineno-11-5>5</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-11-1 name=__codelineno-11-1></a><span class=k>for</span><span class=w> </span><span class=n>face</span><span class=w> </span><span class=k>in</span><span class=w> </span><span class=n>vertex</span><span class=p>.</span><span class=n>adjacent_faces</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w></span>
<a id=__codelineno-11-2 name=__codelineno-11-2></a><span class=w>    </span><span class=k>for</span><span class=w> </span><span class=n>arc</span><span class=w> </span><span class=k>in</span><span class=w> </span><span class=n>face</span><span class=p>.</span><span class=n>adjacent_arcs</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w></span>
<a id=__codelineno-11-3 name=__codelineno-11-3></a><span class=w>        </span><span class=c1>// ...</span>
<a id=__codelineno-11-4 name=__codelineno-11-4></a><span class=w>    </span><span class=p>}</span><span class=w></span>
<a id=__codelineno-11-5 name=__codelineno-11-5></a><span class=p>}</span><span class=w></span>
</code></pre></div></td></tr></table></div> <p>Circulators generally begin iteration from a <a href=../graphs/#representation>leading arc</a> and then traverse topology in a deterministic order from that arc. Because mutability requires orphan views, only the data of adjacent entities can be mutated using circulators.</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-12-1>1</a></span>
<span class=normal><a href=#__codelineno-12-2>2</a></span>
<span class=normal><a href=#__codelineno-12-3>3</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-12-1 name=__codelineno-12-1></a><span class=k>for</span><span class=w> </span><span class=k>mut</span><span class=w> </span><span class=n>face</span><span class=w> </span><span class=k>in</span><span class=w> </span><span class=n>vertex</span><span class=p>.</span><span class=n>adjacent_face_orphans</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w></span>
<a id=__codelineno-12-2 name=__codelineno-12-2></a><span class=w>    </span><span class=o>*</span><span class=n>face</span><span class=p>.</span><span class=n>get_mut</span><span class=p>()</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Color4</span>::<span class=n>white</span><span class=p>();</span><span class=w></span>
<a id=__codelineno-12-3 name=__codelineno-12-3></a><span class=p>}</span><span class=w></span>
</code></pre></div></td></tr></table></div> <p><em>Search traversals</em> visit all connected entities with some notion of adjacency. Both vertices and faces can be traversed in this way to perform searches using breadth- and depth-first ordering.</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-13-1>1</a></span>
<span class=normal><a href=#__codelineno-13-2>2</a></span>
<span class=normal><a href=#__codelineno-13-3>3</a></span>
<span class=normal><a href=#__codelineno-13-4>4</a></span>
<span class=normal><a href=#__codelineno-13-5>5</a></span>
<span class=normal><a href=#__codelineno-13-6>6</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-13-1 name=__codelineno-13-1></a><span class=k>if</span><span class=w> </span><span class=kd>let</span><span class=w> </span><span class=nb>Some</span><span class=p>(</span><span class=n>vertex</span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>vertex</span><span class=w></span>
<a id=__codelineno-13-2 name=__codelineno-13-2></a><span class=w>    </span><span class=p>.</span><span class=n>traverse_by_depth</span><span class=p>()</span><span class=w></span>
<a id=__codelineno-13-3 name=__codelineno-13-3></a><span class=w>    </span><span class=p>.</span><span class=n>find</span><span class=p>(</span><span class=o>|</span><span class=n>vertex</span><span class=o>|</span><span class=w> </span><span class=n>vertex</span><span class=p>.</span><span class=n>get</span><span class=p>()</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=n>target</span><span class=p>)</span><span class=w></span>
<a id=__codelineno-13-4 name=__codelineno-13-4></a><span class=p>{</span><span class=w></span>
<a id=__codelineno-13-5 name=__codelineno-13-5></a><span class=w>    </span><span class=c1>// ...</span>
<a id=__codelineno-13-6 name=__codelineno-13-6></a><span class=p>}</span><span class=w></span>
</code></pre></div></td></tr></table></div> <div class="admonition warning"> <p class=admonition-title>Warning</p> <p>It is possible for vertices and faces to be <em>disjoint</em>, meaning that they do not share a path with all other vertices or faces. Therefore, these traversals are only exhaustive with respect to the topologically connected group with which the initiating view is associated; they do not necessarily visit every vertex or face that is a member of a particular graph.</p> </div> <p><code>MeshGraph</code>s also directly expose entities by type via iterators, but without a deterministic ordering. These categorical iterators are always exhaustive, and visit all topological structures in a graph regardless of their connectivity.</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-14-1> 1</a></span>
<span class=normal><a href=#__codelineno-14-2> 2</a></span>
<span class=normal><a href=#__codelineno-14-3> 3</a></span>
<span class=normal><a href=#__codelineno-14-4> 4</a></span>
<span class=normal><a href=#__codelineno-14-5> 5</a></span>
<span class=normal><a href=#__codelineno-14-6> 6</a></span>
<span class=normal><a href=#__codelineno-14-7> 7</a></span>
<span class=normal><a href=#__codelineno-14-8> 8</a></span>
<span class=normal><a href=#__codelineno-14-9> 9</a></span>
<span class=normal><a href=#__codelineno-14-10>10</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-14-1 name=__codelineno-14-1></a><span class=kd>let</span><span class=w> </span><span class=p>(</span><span class=n>graph</span><span class=p>,</span><span class=w> </span><span class=n>_</span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>MeshGraph</span>::<span class=o>&lt;</span><span class=n>Point3</span><span class=o>&lt;</span><span class=kt>f64</span><span class=o>&gt;&gt;</span>::<span class=n>from_ply</span><span class=p>(</span><span class=w></span>
<a id=__codelineno-14-2 name=__codelineno-14-2></a><span class=w>    </span><span class=n>PositionEncoding</span>::<span class=n>default</span><span class=p>(),</span><span class=w></span>
<a id=__codelineno-14-3 name=__codelineno-14-3></a><span class=w>    </span><span class=n>File</span>::<span class=n>open</span><span class=p>(</span><span class=s>&quot;flower.ply&quot;</span><span class=p>).</span><span class=n>unwrap</span><span class=p>(),</span><span class=w></span>
<a id=__codelineno-14-4 name=__codelineno-14-4></a><span class=p>)</span><span class=w></span>
<a id=__codelineno-14-5 name=__codelineno-14-5></a><span class=p>.</span><span class=n>unwrap</span><span class=p>();</span><span class=w></span>
<a id=__codelineno-14-6 name=__codelineno-14-6></a>
<a id=__codelineno-14-7 name=__codelineno-14-7></a><span class=c1>// Modify the geometry of every vertex.</span>
<a id=__codelineno-14-8 name=__codelineno-14-8></a><span class=k>for</span><span class=w> </span><span class=k>mut</span><span class=w> </span><span class=n>vertex</span><span class=w> </span><span class=k>in</span><span class=w> </span><span class=n>graph</span><span class=p>.</span><span class=n>vertex_orphans</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w></span>
<a id=__codelineno-14-9 name=__codelineno-14-9></a><span class=w>    </span><span class=o>*</span><span class=n>vertex</span><span class=p>.</span><span class=n>get_mut</span><span class=p>()</span><span class=w> </span><span class=o>*=</span><span class=w> </span><span class=mf>2.0</span><span class=p>;</span><span class=w></span>
<a id=__codelineno-14-10 name=__codelineno-14-10></a><span class=p>}</span><span class=w></span>
</code></pre></div></td></tr></table></div> <p>Mutable iterators (including circulators) emit orphan views, because mutable views require exclusive access. To mutate topology using multiple mutable views, use an immutable circulator to collect the keys of the target topology and then lookup each mutable view using those keys.</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-15-1> 1</a></span>
<span class=normal><a href=#__codelineno-15-2> 2</a></span>
<span class=normal><a href=#__codelineno-15-3> 3</a></span>
<span class=normal><a href=#__codelineno-15-4> 4</a></span>
<span class=normal><a href=#__codelineno-15-5> 5</a></span>
<span class=normal><a href=#__codelineno-15-6> 6</a></span>
<span class=normal><a href=#__codelineno-15-7> 7</a></span>
<span class=normal><a href=#__codelineno-15-8> 8</a></span>
<span class=normal><a href=#__codelineno-15-9> 9</a></span>
<span class=normal><a href=#__codelineno-15-10>10</a></span>
<span class=normal><a href=#__codelineno-15-11>11</a></span>
<span class=normal><a href=#__codelineno-15-12>12</a></span>
<span class=normal><a href=#__codelineno-15-13>13</a></span>
<span class=normal><a href=#__codelineno-15-14>14</a></span>
<span class=normal><a href=#__codelineno-15-15>15</a></span>
<span class=normal><a href=#__codelineno-15-16>16</a></span>
<span class=normal><a href=#__codelineno-15-17>17</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-15-1 name=__codelineno-15-1></a><span class=k>type</span> <span class=nc>E3</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Point3</span><span class=o>&lt;</span><span class=n>R64</span><span class=o>&gt;</span><span class=p>;</span><span class=w></span>
<a id=__codelineno-15-2 name=__codelineno-15-2></a>
<a id=__codelineno-15-3 name=__codelineno-15-3></a><span class=c1>// Create a graph with positional data from a unit cube.</span>
<a id=__codelineno-15-4 name=__codelineno-15-4></a><span class=kd>let</span><span class=w> </span><span class=k>mut</span><span class=w> </span><span class=n>graph</span>: <span class=nc>MeshGraph</span><span class=o>&lt;</span><span class=n>E3</span><span class=o>&gt;</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Cube</span>::<span class=n>new</span><span class=p>()</span><span class=w></span>
<a id=__codelineno-15-5 name=__codelineno-15-5></a><span class=w>    </span><span class=p>.</span><span class=n>polygons</span>::<span class=o>&lt;</span><span class=n>Position</span><span class=o>&lt;</span><span class=n>E3</span><span class=o>&gt;&gt;</span><span class=p>()</span><span class=w></span>
<a id=__codelineno-15-6 name=__codelineno-15-6></a><span class=w>    </span><span class=p>.</span><span class=n>collect</span><span class=p>();</span><span class=w></span>
<a id=__codelineno-15-7 name=__codelineno-15-7></a>
<a id=__codelineno-15-8 name=__codelineno-15-8></a><span class=c1>// Collect the keys of the faces in the graph.</span>
<a id=__codelineno-15-9 name=__codelineno-15-9></a><span class=kd>let</span><span class=w> </span><span class=n>keys</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>graph</span><span class=w></span>
<a id=__codelineno-15-10 name=__codelineno-15-10></a><span class=w>    </span><span class=p>.</span><span class=n>faces</span><span class=p>()</span><span class=w></span>
<a id=__codelineno-15-11 name=__codelineno-15-11></a><span class=w>    </span><span class=p>.</span><span class=n>map</span><span class=p>(</span><span class=o>|</span><span class=n>face</span><span class=o>|</span><span class=w> </span><span class=n>face</span><span class=p>.</span><span class=n>key</span><span class=p>())</span><span class=w></span>
<a id=__codelineno-15-12 name=__codelineno-15-12></a><span class=w>    </span><span class=p>.</span><span class=n>collect</span>::<span class=o>&lt;</span><span class=n>ArrayVec</span><span class=o>&lt;</span><span class=p>[</span><span class=n>_</span><span class=p>;</span><span class=w> </span><span class=mi>6</span><span class=p>]</span><span class=o>&gt;&gt;</span><span class=p>();</span><span class=w></span>
<a id=__codelineno-15-13 name=__codelineno-15-13></a><span class=k>for</span><span class=w> </span><span class=n>key</span><span class=w> </span><span class=k>in</span><span class=w> </span><span class=n>keys</span><span class=w> </span><span class=p>{</span><span class=w></span>
<a id=__codelineno-15-14 name=__codelineno-15-14></a><span class=w>    </span><span class=c1>// Get a mutable face view for each key.</span>
<a id=__codelineno-15-15 name=__codelineno-15-15></a><span class=w>    </span><span class=c1>// Poke each face and translate the centroid along the face&#39;s normal.</span>
<a id=__codelineno-15-16 name=__codelineno-15-16></a><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>_</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>graph</span><span class=p>.</span><span class=n>face_mut</span><span class=p>(</span><span class=n>key</span><span class=p>).</span><span class=n>expect</span><span class=p>(</span><span class=s>&quot;independent&quot;</span><span class=p>).</span><span class=n>poke_with_offset</span><span class=p>(</span><span class=mf>0.5</span><span class=p>);</span><span class=w></span>
<a id=__codelineno-15-17 name=__codelineno-15-17></a><span class=p>}</span><span class=w></span>
</code></pre></div></td></tr></table></div> <div class="admonition note"> <p class=admonition-title>Note</p> <p>Mutations may be <em>dependent</em> and invalidate keys. Some mutations may not be able to operate on the given set of keys as trivially as seen in the example above. Poking a face is an independent mutation and does not affect other faces in a graph.</p> </div> <h2 id=topological-mutations>Topological Mutations<a class=headerlink href=#topological-mutations title="Permanent link">&para;</a></h2> <p>Mutable views expose topological mutations that alter the structure of a graph. These operations are always consuming, because they often invalidate the view that initiates them.</p> <p>Most mutations return a view over a modified or newly inserted topological structure that can be used to further traverse the graph. For example, splitting an arc <span class=arithmatex><span class=MathJax_Preview>\overrightarrow{AB}</span><script type=math/tex>\overrightarrow{AB}</script></span> returns a vertex <span class=arithmatex><span class=MathJax_Preview>M</span><script type=math/tex>M</script></span> that subdivides the composite edge. The leading arc of <span class=arithmatex><span class=MathJax_Preview>M</span><script type=math/tex>M</script></span> is <span class=arithmatex><span class=MathJax_Preview>\overrightarrow{MB}</span><script type=math/tex>\overrightarrow{MB}</script></span> and is a part of the same ring as the initiating arc.</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-16-1>1</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-16-1 name=__codelineno-16-1></a><span class=kd>let</span><span class=w> </span><span class=n>vertex</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>arc</span><span class=p>.</span><span class=n>split_at_midpoint</span><span class=p>();</span><span class=w> </span><span class=c1>// Consumes `arc`. `vertex` is mutable.</span>
</code></pre></div></td></tr></table></div> <p>It is possible to downgrade mutable views into immutable views using <code>into_ref</code>. This can be useful when performing topological mutations, as it allows for any number of traversals immediately after the mutation is performed.</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-17-1> 1</a></span>
<span class=normal><a href=#__codelineno-17-2> 2</a></span>
<span class=normal><a href=#__codelineno-17-3> 3</a></span>
<span class=normal><a href=#__codelineno-17-4> 4</a></span>
<span class=normal><a href=#__codelineno-17-5> 5</a></span>
<span class=normal><a href=#__codelineno-17-6> 6</a></span>
<span class=normal><a href=#__codelineno-17-7> 7</a></span>
<span class=normal><a href=#__codelineno-17-8> 8</a></span>
<span class=normal><a href=#__codelineno-17-9> 9</a></span>
<span class=normal><a href=#__codelineno-17-10>10</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-17-1 name=__codelineno-17-1></a><span class=c1>// Split an arc and use `into_ref` to get an immutable view.</span>
<a id=__codelineno-17-2 name=__codelineno-17-2></a><span class=kd>let</span><span class=w> </span><span class=n>vertex</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>arc</span><span class=p>.</span><span class=n>split_at_midpoint</span><span class=p>().</span><span class=n>into_ref</span><span class=p>();</span><span class=w></span>
<a id=__codelineno-17-3 name=__codelineno-17-3></a>
<a id=__codelineno-17-4 name=__codelineno-17-4></a><span class=c1>// `vertex` is immutable and implements `Copy`.</span>
<a id=__codelineno-17-5 name=__codelineno-17-5></a><span class=kd>let</span><span class=w> </span><span class=n>source</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>vertex</span><span class=w></span>
<a id=__codelineno-17-6 name=__codelineno-17-6></a><span class=w>    </span><span class=p>.</span><span class=n>into_outgoing_arc</span><span class=p>()</span><span class=w></span>
<a id=__codelineno-17-7 name=__codelineno-17-7></a><span class=w>    </span><span class=p>.</span><span class=n>into_previous_arc</span><span class=p>()</span><span class=w></span>
<a id=__codelineno-17-8 name=__codelineno-17-8></a><span class=w>    </span><span class=p>.</span><span class=n>into_source_vertex</span><span class=p>();</span><span class=w></span>
<a id=__codelineno-17-9 name=__codelineno-17-9></a><span class=kd>let</span><span class=w> </span><span class=n>destination</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>vertex</span><span class=p>.</span><span class=n>into_outgoing_arc</span><span class=p>().</span><span class=n>into_destination_vertex</span><span class=p>();</span><span class=w></span>
<a id=__codelineno-17-10 name=__codelineno-17-10></a><span class=kd>let</span><span class=w> </span><span class=n>span</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=n>source</span><span class=p>,</span><span class=w> </span><span class=n>destination</span><span class=p>);</span><span class=w></span>
</code></pre></div></td></tr></table></div> <p>Graphs also provide topological mutations that may operate over an entire graph.</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-18-1> 1</a></span>
<span class=normal><a href=#__codelineno-18-2> 2</a></span>
<span class=normal><a href=#__codelineno-18-3> 3</a></span>
<span class=normal><a href=#__codelineno-18-4> 4</a></span>
<span class=normal><a href=#__codelineno-18-5> 5</a></span>
<span class=normal><a href=#__codelineno-18-6> 6</a></span>
<span class=normal><a href=#__codelineno-18-7> 7</a></span>
<span class=normal><a href=#__codelineno-18-8> 8</a></span>
<span class=normal><a href=#__codelineno-18-9> 9</a></span>
<span class=normal><a href=#__codelineno-18-10>10</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-18-1 name=__codelineno-18-1></a><span class=k>type</span> <span class=nc>E3</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Point3</span><span class=o>&lt;</span><span class=n>R64</span><span class=o>&gt;</span><span class=p>;</span><span class=w></span>
<a id=__codelineno-18-2 name=__codelineno-18-2></a>
<a id=__codelineno-18-3 name=__codelineno-18-3></a><span class=kd>let</span><span class=w> </span><span class=n>cube</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Cube</span>::<span class=n>new</span><span class=p>();</span><span class=w></span>
<a id=__codelineno-18-4 name=__codelineno-18-4></a><span class=kd>let</span><span class=w> </span><span class=k>mut</span><span class=w> </span><span class=n>graph</span>: <span class=nc>MeshGraph</span><span class=o>&lt;</span><span class=n>Vertex</span><span class=o>&gt;</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>primitive</span>::<span class=n>zip_vertices</span><span class=p>((</span><span class=w></span>
<a id=__codelineno-18-5 name=__codelineno-18-5></a><span class=w>    </span><span class=n>cube</span><span class=p>.</span><span class=n>polygons</span>::<span class=o>&lt;</span><span class=n>Position</span><span class=o>&lt;</span><span class=n>E3</span><span class=o>&gt;&gt;</span><span class=p>(),</span><span class=w></span>
<a id=__codelineno-18-6 name=__codelineno-18-6></a><span class=w>    </span><span class=n>cube</span><span class=p>.</span><span class=n>polygons</span>::<span class=o>&lt;</span><span class=n>Normal</span><span class=o>&lt;</span><span class=n>E3</span><span class=o>&gt;&gt;</span><span class=p>(),</span><span class=w></span>
<a id=__codelineno-18-7 name=__codelineno-18-7></a><span class=p>))</span><span class=w></span>
<a id=__codelineno-18-8 name=__codelineno-18-8></a><span class=p>.</span><span class=n>collect</span><span class=p>();</span><span class=w></span>
<a id=__codelineno-18-9 name=__codelineno-18-9></a>
<a id=__codelineno-18-10 name=__codelineno-18-10></a><span class=n>graph</span><span class=p>.</span><span class=n>triangulate</span><span class=p>();</span><span class=w> </span><span class=c1>// Triangulates all faces in the graph.</span>
</code></pre></div></td></tr></table></div> <p>Graphs may contain <em>disjoint sub-graphs</em>, which are topological groups that cannot reach each other. It is possible to split a graph into sub-graphs.</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-19-1> 1</a></span>
<span class=normal><a href=#__codelineno-19-2> 2</a></span>
<span class=normal><a href=#__codelineno-19-3> 3</a></span>
<span class=normal><a href=#__codelineno-19-4> 4</a></span>
<span class=normal><a href=#__codelineno-19-5> 5</a></span>
<span class=normal><a href=#__codelineno-19-6> 6</a></span>
<span class=normal><a href=#__codelineno-19-7> 7</a></span>
<span class=normal><a href=#__codelineno-19-8> 8</a></span>
<span class=normal><a href=#__codelineno-19-9> 9</a></span>
<span class=normal><a href=#__codelineno-19-10>10</a></span>
<span class=normal><a href=#__codelineno-19-11>11</a></span>
<span class=normal><a href=#__codelineno-19-12>12</a></span>
<span class=normal><a href=#__codelineno-19-13>13</a></span>
<span class=normal><a href=#__codelineno-19-14>14</a></span>
<span class=normal><a href=#__codelineno-19-15>15</a></span>
<span class=normal><a href=#__codelineno-19-16>16</a></span>
<span class=normal><a href=#__codelineno-19-17>17</a></span>
<span class=normal><a href=#__codelineno-19-18>18</a></span>
<span class=normal><a href=#__codelineno-19-19>19</a></span>
<span class=normal><a href=#__codelineno-19-20>20</a></span>
<span class=normal><a href=#__codelineno-19-21>21</a></span>
<span class=normal><a href=#__codelineno-19-22>22</a></span>
<span class=normal><a href=#__codelineno-19-23>23</a></span>
<span class=normal><a href=#__codelineno-19-24>24</a></span>
<span class=normal><a href=#__codelineno-19-25>25</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-19-1 name=__codelineno-19-1></a><span class=c1>// Create a graph of two squares sharing a single edge.</span>
<a id=__codelineno-19-2 name=__codelineno-19-2></a><span class=kd>let</span><span class=w> </span><span class=k>mut</span><span class=w> </span><span class=n>graph</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>MeshGraph</span>::<span class=o>&lt;</span><span class=n>Point2</span><span class=o>&lt;</span><span class=kt>f64</span><span class=o>&gt;&gt;</span>::<span class=n>from_raw_buffers</span><span class=p>(</span><span class=w></span>
<a id=__codelineno-19-3 name=__codelineno-19-3></a><span class=w>    </span><span class=fm>vec!</span><span class=p>[</span><span class=n>Tetragon</span>::<span class=n>new</span><span class=p>(</span><span class=mi>0</span><span class=k>usize</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>,</span><span class=w> </span><span class=mi>3</span><span class=p>),</span><span class=w> </span><span class=n>Tetragon</span>::<span class=n>new</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=mi>3</span><span class=p>,</span><span class=w> </span><span class=mi>4</span><span class=p>,</span><span class=w> </span><span class=mi>5</span><span class=p>)],</span><span class=w></span>
<a id=__codelineno-19-4 name=__codelineno-19-4></a><span class=w>    </span><span class=fm>vec!</span><span class=p>[</span><span class=w></span>
<a id=__codelineno-19-5 name=__codelineno-19-5></a><span class=w>        </span><span class=p>(</span><span class=mf>0.0</span><span class=p>,</span><span class=w> </span><span class=mf>0.0</span><span class=p>),</span><span class=w></span>
<a id=__codelineno-19-6 name=__codelineno-19-6></a><span class=w>        </span><span class=p>(</span><span class=mf>1.0</span><span class=p>,</span><span class=w> </span><span class=mf>0.0</span><span class=p>),</span><span class=w></span>
<a id=__codelineno-19-7 name=__codelineno-19-7></a><span class=w>        </span><span class=p>(</span><span class=mf>1.0</span><span class=p>,</span><span class=w> </span><span class=mf>1.0</span><span class=p>),</span><span class=w></span>
<a id=__codelineno-19-8 name=__codelineno-19-8></a><span class=w>        </span><span class=p>(</span><span class=mf>0.0</span><span class=p>,</span><span class=w> </span><span class=mf>1.0</span><span class=p>),</span><span class=w></span>
<a id=__codelineno-19-9 name=__codelineno-19-9></a><span class=w>        </span><span class=p>(</span><span class=o>-</span><span class=mf>1.0</span><span class=p>,</span><span class=w> </span><span class=mf>1.0</span><span class=p>),</span><span class=w></span>
<a id=__codelineno-19-10 name=__codelineno-19-10></a><span class=w>        </span><span class=p>(</span><span class=o>-</span><span class=mf>1.0</span><span class=p>,</span><span class=w> </span><span class=mf>0.0</span><span class=p>),</span><span class=w></span>
<a id=__codelineno-19-11 name=__codelineno-19-11></a><span class=w>    </span><span class=p>],</span><span class=w></span>
<a id=__codelineno-19-12 name=__codelineno-19-12></a><span class=p>)</span><span class=w></span>
<a id=__codelineno-19-13 name=__codelineno-19-13></a><span class=p>.</span><span class=n>unwrap</span><span class=p>();</span><span class=w></span>
<a id=__codelineno-19-14 name=__codelineno-19-14></a>
<a id=__codelineno-19-15 name=__codelineno-19-15></a><span class=c1>// Find the shared edge and a get a path along one of its arcs.</span>
<a id=__codelineno-19-16 name=__codelineno-19-16></a><span class=kd>let</span><span class=w> </span><span class=n>key</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>graph</span><span class=w></span>
<a id=__codelineno-19-17 name=__codelineno-19-17></a><span class=w>    </span><span class=p>.</span><span class=n>edges</span><span class=p>()</span><span class=w></span>
<a id=__codelineno-19-18 name=__codelineno-19-18></a><span class=w>    </span><span class=p>.</span><span class=n>find</span><span class=p>(</span><span class=o>|</span><span class=n>edge</span><span class=o>|</span><span class=w> </span><span class=o>!</span><span class=n>edge</span><span class=p>.</span><span class=n>is_boundary_edge</span><span class=p>())</span><span class=w></span>
<a id=__codelineno-19-19 name=__codelineno-19-19></a><span class=w>    </span><span class=p>.</span><span class=n>map</span><span class=p>(</span><span class=o>|</span><span class=n>edge</span><span class=o>|</span><span class=w> </span><span class=n>edge</span><span class=p>.</span><span class=n>key</span><span class=p>())</span><span class=w></span>
<a id=__codelineno-19-20 name=__codelineno-19-20></a><span class=w>    </span><span class=p>.</span><span class=n>unwrap</span><span class=p>();</span><span class=w></span>
<a id=__codelineno-19-21 name=__codelineno-19-21></a><span class=kd>let</span><span class=w> </span><span class=n>path</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>graph</span><span class=p>.</span><span class=n>edge_mut</span><span class=p>(</span><span class=n>key</span><span class=p>).</span><span class=n>unwrap</span><span class=p>().</span><span class=n>into_arc</span><span class=p>().</span><span class=n>into_path</span><span class=p>();</span><span class=w></span>
<a id=__codelineno-19-22 name=__codelineno-19-22></a>
<a id=__codelineno-19-23 name=__codelineno-19-23></a><span class=c1>// Split the graph into two disjoint sub-graphs.</span>
<a id=__codelineno-19-24 name=__codelineno-19-24></a><span class=n>MeshGraph</span>::<span class=n>split_at_path</span><span class=p>(</span><span class=n>path</span><span class=p>).</span><span class=n>unwrap</span><span class=p>();</span><span class=w></span>
<a id=__codelineno-19-25 name=__codelineno-19-25></a><span class=kd>let</span><span class=w> </span><span class=n>graphs</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>graph</span><span class=p>.</span><span class=n>into_disjoint_subgraphs</span><span class=p>();</span><span class=w></span>
</code></pre></div></td></tr></table></div> <p>Topological mutations expose spatial functions for types that implement geometric traits, such as <code>split_at_midpoint</code>. Views also expose purely topological functions, which can always be used (if, for example, the data in a graph is non-spatial).</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-20-1> 1</a></span>
<span class=normal><a href=#__codelineno-20-2> 2</a></span>
<span class=normal><a href=#__codelineno-20-3> 3</a></span>
<span class=normal><a href=#__codelineno-20-4> 4</a></span>
<span class=normal><a href=#__codelineno-20-5> 5</a></span>
<span class=normal><a href=#__codelineno-20-6> 6</a></span>
<span class=normal><a href=#__codelineno-20-7> 7</a></span>
<span class=normal><a href=#__codelineno-20-8> 8</a></span>
<span class=normal><a href=#__codelineno-20-9> 9</a></span>
<span class=normal><a href=#__codelineno-20-10>10</a></span>
<span class=normal><a href=#__codelineno-20-11>11</a></span>
<span class=normal><a href=#__codelineno-20-12>12</a></span>
<span class=normal><a href=#__codelineno-20-13>13</a></span>
<span class=normal><a href=#__codelineno-20-14>14</a></span>
<span class=normal><a href=#__codelineno-20-15>15</a></span>
<span class=normal><a href=#__codelineno-20-16>16</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-20-1 name=__codelineno-20-1></a><span class=k>pub</span><span class=w> </span><span class=k>enum</span> <span class=nc>Weight</span><span class=w> </span><span class=p>{}</span><span class=w></span>
<a id=__codelineno-20-2 name=__codelineno-20-2></a>
<a id=__codelineno-20-3 name=__codelineno-20-3></a><span class=k>impl</span><span class=w> </span><span class=n>GraphData</span><span class=w> </span><span class=k>for</span><span class=w> </span><span class=n>Weight</span><span class=w> </span><span class=p>{</span><span class=w></span>
<a id=__codelineno-20-4 name=__codelineno-20-4></a><span class=w>    </span><span class=k>type</span> <span class=nc>Vertex</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=kt>f64</span><span class=p>;</span><span class=w></span>
<a id=__codelineno-20-5 name=__codelineno-20-5></a><span class=w>    </span><span class=k>type</span> <span class=nc>Arc</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>();</span><span class=w></span>
<a id=__codelineno-20-6 name=__codelineno-20-6></a><span class=w>    </span><span class=k>type</span> <span class=nc>Edge</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>();</span><span class=w></span>
<a id=__codelineno-20-7 name=__codelineno-20-7></a><span class=w>    </span><span class=k>type</span> <span class=nc>Face</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>();</span><span class=w></span>
<a id=__codelineno-20-8 name=__codelineno-20-8></a><span class=p>}</span><span class=w></span>
<a id=__codelineno-20-9 name=__codelineno-20-9></a>
<a id=__codelineno-20-10 name=__codelineno-20-10></a><span class=kd>let</span><span class=w> </span><span class=k>mut</span><span class=w> </span><span class=n>graph</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>MeshGraph</span>::<span class=o>&lt;</span><span class=n>Weight</span><span class=o>&gt;</span>::<span class=n>from_raw_buffers</span><span class=p>(</span><span class=w></span>
<a id=__codelineno-20-11 name=__codelineno-20-11></a><span class=w>    </span><span class=fm>vec!</span><span class=p>[</span><span class=n>Trigon</span>::<span class=n>new</span><span class=p>(</span><span class=mi>0</span><span class=k>usize</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>)],</span><span class=w></span>
<a id=__codelineno-20-12 name=__codelineno-20-12></a><span class=w>    </span><span class=fm>vec!</span><span class=p>[</span><span class=mf>1.0</span><span class=p>,</span><span class=w> </span><span class=mf>2.0</span><span class=p>,</span><span class=w> </span><span class=mf>0.5</span><span class=p>],</span><span class=w></span>
<a id=__codelineno-20-13 name=__codelineno-20-13></a><span class=p>)</span><span class=w></span>
<a id=__codelineno-20-14 name=__codelineno-20-14></a><span class=p>.</span><span class=n>expect</span><span class=p>(</span><span class=s>&quot;triangle&quot;</span><span class=p>);</span><span class=w></span>
<a id=__codelineno-20-15 name=__codelineno-20-15></a><span class=kd>let</span><span class=w> </span><span class=n>key</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>graph</span><span class=p>.</span><span class=n>arcs</span><span class=p>().</span><span class=n>nth</span><span class=p>(</span><span class=mi>0</span><span class=p>).</span><span class=n>expect</span><span class=p>(</span><span class=s>&quot;triangle&quot;</span><span class=p>).</span><span class=n>key</span><span class=p>();</span><span class=w></span>
<a id=__codelineno-20-16 name=__codelineno-20-16></a><span class=kd>let</span><span class=w> </span><span class=n>vertex</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>graph</span><span class=p>.</span><span class=n>arc_mut</span><span class=p>(</span><span class=n>key</span><span class=p>).</span><span class=n>unwrap</span><span class=p>().</span><span class=n>split_with</span><span class=p>(</span><span class=o>||</span><span class=w> </span><span class=mf>0.1</span><span class=p>);</span><span class=w></span>
</code></pre></div></td></tr></table></div> <p>In the above example, <code>split_with</code> accepts a function that returns data for the subdividing vertex of the split. Similar functions exist for other topological mutations as well, such as <code>poke_with</code>.</p> <h2 id=computation-vs-payload>Computation vs. Payload<a class=headerlink href=#computation-vs-payload title="Permanent link">&para;</a></h2> <p>When graph data implements geometric traits, views expose methods to compute related attributes like normals and centroids.</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-21-1>1</a></span>
<span class=normal><a href=#__codelineno-21-2>2</a></span>
<span class=normal><a href=#__codelineno-21-3>3</a></span>
<span class=normal><a href=#__codelineno-21-4>4</a></span>
<span class=normal><a href=#__codelineno-21-5>5</a></span>
<span class=normal><a href=#__codelineno-21-6>6</a></span>
<span class=normal><a href=#__codelineno-21-7>7</a></span>
<span class=normal><a href=#__codelineno-21-8>8</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-21-1 name=__codelineno-21-1></a><span class=kd>let</span><span class=w> </span><span class=p>(</span><span class=n>graph</span><span class=p>,</span><span class=w> </span><span class=n>_</span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>MeshGraph</span>::<span class=o>&lt;</span><span class=n>Point3</span><span class=o>&lt;</span><span class=kt>f64</span><span class=o>&gt;&gt;</span>::<span class=n>from_ply</span><span class=p>(</span><span class=w></span>
<a id=__codelineno-21-2 name=__codelineno-21-2></a><span class=w>    </span><span class=n>PositionEncoding</span>::<span class=n>default</span><span class=p>(),</span><span class=w></span>
<a id=__codelineno-21-3 name=__codelineno-21-3></a><span class=w>    </span><span class=n>File</span>::<span class=n>open</span><span class=p>(</span><span class=s>&quot;teapot.ply&quot;</span><span class=p>).</span><span class=n>unwrap</span><span class=p>(),</span><span class=w></span>
<a id=__codelineno-21-4 name=__codelineno-21-4></a><span class=p>)</span><span class=w></span>
<a id=__codelineno-21-5 name=__codelineno-21-5></a><span class=p>.</span><span class=n>unwrap</span><span class=p>();</span><span class=w></span>
<a id=__codelineno-21-6 name=__codelineno-21-6></a>
<a id=__codelineno-21-7 name=__codelineno-21-7></a><span class=c1>// Computes the centroid of the face.</span>
<a id=__codelineno-21-8 name=__codelineno-21-8></a><span class=kd>let</span><span class=w> </span><span class=n>centroid</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>graph</span><span class=p>.</span><span class=n>faces</span><span class=p>().</span><span class=n>nth</span><span class=p>(</span><span class=mi>0</span><span class=p>).</span><span class=n>unwrap</span><span class=p>().</span><span class=n>centroid</span><span class=p>();</span><span class=w></span>
</code></pre></div></td></tr></table></div> <p>These computations are based on the positional data in vertices. However, it is also possible to include these attributes in the data of a graph and assign arbitrary values as needed. For example, it is sometimes desirable to establish vertex normals independently of surrounding face or edge geometry.</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-22-1> 1</a></span>
<span class=normal><a href=#__codelineno-22-2> 2</a></span>
<span class=normal><a href=#__codelineno-22-3> 3</a></span>
<span class=normal><a href=#__codelineno-22-4> 4</a></span>
<span class=normal><a href=#__codelineno-22-5> 5</a></span>
<span class=normal><a href=#__codelineno-22-6> 6</a></span>
<span class=normal><a href=#__codelineno-22-7> 7</a></span>
<span class=normal><a href=#__codelineno-22-8> 8</a></span>
<span class=normal><a href=#__codelineno-22-9> 9</a></span>
<span class=normal><a href=#__codelineno-22-10>10</a></span>
<span class=normal><a href=#__codelineno-22-11>11</a></span>
<span class=normal><a href=#__codelineno-22-12>12</a></span>
<span class=normal><a href=#__codelineno-22-13>13</a></span>
<span class=normal><a href=#__codelineno-22-14>14</a></span>
<span class=normal><a href=#__codelineno-22-15>15</a></span>
<span class=normal><a href=#__codelineno-22-16>16</a></span>
<span class=normal><a href=#__codelineno-22-17>17</a></span>
<span class=normal><a href=#__codelineno-22-18>18</a></span>
<span class=normal><a href=#__codelineno-22-19>19</a></span>
<span class=normal><a href=#__codelineno-22-20>20</a></span>
<span class=normal><a href=#__codelineno-22-21>21</a></span>
<span class=normal><a href=#__codelineno-22-22>22</a></span>
<span class=normal><a href=#__codelineno-22-23>23</a></span>
<span class=normal><a href=#__codelineno-22-24>24</a></span>
<span class=normal><a href=#__codelineno-22-25>25</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-22-1 name=__codelineno-22-1></a><span class=k>type</span> <span class=nc>E3</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Point3</span><span class=o>&lt;</span><span class=n>R64</span><span class=o>&gt;</span><span class=p>;</span><span class=w></span>
<a id=__codelineno-22-2 name=__codelineno-22-2></a>
<a id=__codelineno-22-3 name=__codelineno-22-3></a><span class=k>pub</span><span class=w> </span><span class=k>struct</span> <span class=nc>Vertex</span><span class=w> </span><span class=p>{</span><span class=w></span>
<a id=__codelineno-22-4 name=__codelineno-22-4></a><span class=w>    </span><span class=k>pub</span><span class=w> </span><span class=n>position</span>: <span class=nc>E3</span><span class=w></span>
<a id=__codelineno-22-5 name=__codelineno-22-5></a><span class=w>    </span><span class=k>pub</span><span class=w> </span><span class=n>normal</span>: <span class=nc>Unit</span><span class=o>&lt;</span><span class=n>Vector</span><span class=o>&lt;</span><span class=n>E3</span><span class=o>&gt;&gt;</span><span class=p>,</span><span class=w></span>
<a id=__codelineno-22-6 name=__codelineno-22-6></a><span class=p>}</span><span class=w></span>
<a id=__codelineno-22-7 name=__codelineno-22-7></a>
<a id=__codelineno-22-8 name=__codelineno-22-8></a><span class=k>impl</span><span class=w> </span><span class=n>GraphData</span><span class=w> </span><span class=k>for</span><span class=w> </span><span class=n>Vertex</span><span class=w> </span><span class=p>{</span><span class=w></span>
<a id=__codelineno-22-9 name=__codelineno-22-9></a><span class=w>    </span><span class=k>type</span> <span class=nc>Vertex</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=bp>Self</span><span class=p>;</span><span class=w></span>
<a id=__codelineno-22-10 name=__codelineno-22-10></a><span class=w>    </span><span class=k>type</span> <span class=nc>Arc</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>();</span><span class=w></span>
<a id=__codelineno-22-11 name=__codelineno-22-11></a><span class=w>    </span><span class=k>type</span> <span class=nc>Edge</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>();</span><span class=w></span>
<a id=__codelineno-22-12 name=__codelineno-22-12></a><span class=w>    </span><span class=k>type</span> <span class=nc>Face</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>();</span><span class=w></span>
<a id=__codelineno-22-13 name=__codelineno-22-13></a><span class=p>}</span><span class=w></span>
<a id=__codelineno-22-14 name=__codelineno-22-14></a>
<a id=__codelineno-22-15 name=__codelineno-22-15></a><span class=kd>let</span><span class=w> </span><span class=k>mut</span><span class=w> </span><span class=n>graph</span>: <span class=nc>MeshGraph</span><span class=o>&lt;</span><span class=n>Vertex</span><span class=o>&gt;</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Cube</span>::<span class=n>new</span><span class=p>()</span><span class=w></span>
<a id=__codelineno-22-16 name=__codelineno-22-16></a><span class=w>    </span><span class=p>.</span><span class=n>polygons</span>::<span class=o>&lt;</span><span class=n>Position</span><span class=o>&lt;</span><span class=n>E3</span><span class=o>&gt;&gt;</span><span class=p>()</span><span class=w></span>
<a id=__codelineno-22-17 name=__codelineno-22-17></a><span class=w>    </span><span class=p>.</span><span class=n>map_vertices</span><span class=p>(</span><span class=o>|</span><span class=n>position</span><span class=o>|</span><span class=w> </span><span class=n>Vertex</span><span class=w> </span><span class=p>{</span><span class=w></span>
<a id=__codelineno-22-18 name=__codelineno-22-18></a><span class=w>        </span><span class=n>position</span><span class=p>,</span><span class=w></span>
<a id=__codelineno-22-19 name=__codelineno-22-19></a><span class=w>        </span><span class=n>normal</span>: <span class=nc>Unit</span>::<span class=n>x</span><span class=p>(),</span><span class=w></span>
<a id=__codelineno-22-20 name=__codelineno-22-20></a><span class=w>    </span><span class=p>})</span><span class=w></span>
<a id=__codelineno-22-21 name=__codelineno-22-21></a><span class=w>    </span><span class=p>.</span><span class=n>collect</span><span class=p>();</span><span class=w></span>
<a id=__codelineno-22-22 name=__codelineno-22-22></a>
<a id=__codelineno-22-23 name=__codelineno-22-23></a><span class=c1>// Write arbitrary data to the payload.</span>
<a id=__codelineno-22-24 name=__codelineno-22-24></a><span class=kd>let</span><span class=w> </span><span class=k>mut</span><span class=w> </span><span class=n>vertex</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>graph</span><span class=p>.</span><span class=n>vertex_orphans</span><span class=p>().</span><span class=n>nth</span><span class=p>(</span><span class=mi>0</span><span class=p>).</span><span class=n>unwrap</span><span class=p>();</span><span class=w></span>
<a id=__codelineno-22-25 name=__codelineno-22-25></a><span class=n>vertex</span><span class=p>.</span><span class=n>get_mut</span><span class=p>().</span><span class=n>normal</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Unit</span>::<span class=n>z</span><span class=p>();</span><span class=w></span>
</code></pre></div></td></tr></table></div> <p>The above example uses the <code>Vertex</code> type to store a position and normal in each vertex. This is distinct from computed attributes, as this normal is arbitrary and is not recomputed when it is accessed. Applications may choose either approach, though computation is typically preferable.</p> <h2 id=generic-programming>Generic Programming<a class=headerlink href=#generic-programming title="Permanent link">&para;</a></h2> <p>The <code>graph</code> module provides traits that express the geometric capabilities of a <code>MeshGraph</code>. These can be used to write generic code that requires particular geometric operations, such as computing edge midpoints. This example subdivides a face in a mesh by splitting arcs at their midpoints:</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-23-1> 1</a></span>
<span class=normal><a href=#__codelineno-23-2> 2</a></span>
<span class=normal><a href=#__codelineno-23-3> 3</a></span>
<span class=normal><a href=#__codelineno-23-4> 4</a></span>
<span class=normal><a href=#__codelineno-23-5> 5</a></span>
<span class=normal><a href=#__codelineno-23-6> 6</a></span>
<span class=normal><a href=#__codelineno-23-7> 7</a></span>
<span class=normal><a href=#__codelineno-23-8> 8</a></span>
<span class=normal><a href=#__codelineno-23-9> 9</a></span>
<span class=normal><a href=#__codelineno-23-10>10</a></span>
<span class=normal><a href=#__codelineno-23-11>11</a></span>
<span class=normal><a href=#__codelineno-23-12>12</a></span>
<span class=normal><a href=#__codelineno-23-13>13</a></span>
<span class=normal><a href=#__codelineno-23-14>14</a></span>
<span class=normal><a href=#__codelineno-23-15>15</a></span>
<span class=normal><a href=#__codelineno-23-16>16</a></span>
<span class=normal><a href=#__codelineno-23-17>17</a></span>
<span class=normal><a href=#__codelineno-23-18>18</a></span>
<span class=normal><a href=#__codelineno-23-19>19</a></span>
<span class=normal><a href=#__codelineno-23-20>20</a></span>
<span class=normal><a href=#__codelineno-23-21>21</a></span>
<span class=normal><a href=#__codelineno-23-22>22</a></span>
<span class=normal><a href=#__codelineno-23-23>23</a></span>
<span class=normal><a href=#__codelineno-23-24>24</a></span>
<span class=normal><a href=#__codelineno-23-25>25</a></span>
<span class=normal><a href=#__codelineno-23-26>26</a></span>
<span class=normal><a href=#__codelineno-23-27>27</a></span>
<span class=normal><a href=#__codelineno-23-28>28</a></span>
<span class=normal><a href=#__codelineno-23-29>29</a></span>
<span class=normal><a href=#__codelineno-23-30>30</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-23-1 name=__codelineno-23-1></a><span class=k>pub</span><span class=w> </span><span class=k>trait</span><span class=w> </span><span class=n>Circumscribe</span><span class=o>&lt;</span><span class=n>G</span><span class=o>&gt;</span><span class=w> </span><span class=p>{</span><span class=w></span>
<a id=__codelineno-23-2 name=__codelineno-23-2></a><span class=w>    </span><span class=k>fn</span> <span class=nf>circumscribe</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span><span class=w> </span>-&gt; <span class=nc>Self</span><span class=p>;</span><span class=w></span>
<a id=__codelineno-23-3 name=__codelineno-23-3></a><span class=p>}</span><span class=w></span>
<a id=__codelineno-23-4 name=__codelineno-23-4></a>
<a id=__codelineno-23-5 name=__codelineno-23-5></a><span class=k>impl</span><span class=o>&lt;&#39;</span><span class=na>a</span><span class=p>,</span><span class=w> </span><span class=n>G</span><span class=o>&gt;</span><span class=w> </span><span class=n>Circumscribe</span><span class=o>&lt;</span><span class=n>G</span><span class=o>&gt;</span><span class=w> </span><span class=k>for</span><span class=w> </span><span class=n>FaceView</span><span class=o>&lt;&amp;&#39;</span><span class=na>a</span><span class=w> </span><span class=k>mut</span><span class=w> </span><span class=n>MeshGraph</span><span class=o>&lt;</span><span class=n>G</span><span class=o>&gt;&gt;</span><span class=w></span>
<a id=__codelineno-23-6 name=__codelineno-23-6></a><span class=k>where</span><span class=w></span>
<a id=__codelineno-23-7 name=__codelineno-23-7></a><span class=w>    </span><span class=n>G</span>: <span class=nc>EdgeMidpoint</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>GraphData</span><span class=p>,</span><span class=w></span>
<a id=__codelineno-23-8 name=__codelineno-23-8></a><span class=w>    </span><span class=n>G</span>::<span class=n>Vertex</span>: <span class=nc>AsPositionMut</span><span class=p>,</span><span class=w></span>
<a id=__codelineno-23-9 name=__codelineno-23-9></a><span class=p>{</span><span class=w></span>
<a id=__codelineno-23-10 name=__codelineno-23-10></a><span class=w>    </span><span class=c1>// Subdivide the face such that a similar polygon is formed within its</span>
<a id=__codelineno-23-11 name=__codelineno-23-11></a><span class=w>    </span><span class=c1>// perimeter.</span>
<a id=__codelineno-23-12 name=__codelineno-23-12></a><span class=w>    </span><span class=k>fn</span> <span class=nf>circumscribe</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span><span class=w> </span>-&gt; <span class=nc>Self</span><span class=w> </span><span class=p>{</span><span class=w></span>
<a id=__codelineno-23-13 name=__codelineno-23-13></a><span class=w>        </span><span class=c1>// Split each edge, stashing the vertex key and moving to the next arc.</span>
<a id=__codelineno-23-14 name=__codelineno-23-14></a><span class=w>        </span><span class=kd>let</span><span class=w> </span><span class=n>arity</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=bp>self</span><span class=p>.</span><span class=n>arity</span><span class=p>();</span><span class=w></span>
<a id=__codelineno-23-15 name=__codelineno-23-15></a><span class=w>        </span><span class=kd>let</span><span class=w> </span><span class=k>mut</span><span class=w> </span><span class=n>arc</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=bp>self</span><span class=p>.</span><span class=n>into_arc</span><span class=p>();</span><span class=w></span>
<a id=__codelineno-23-16 name=__codelineno-23-16></a><span class=w>        </span><span class=kd>let</span><span class=w> </span><span class=k>mut</span><span class=w> </span><span class=n>splits</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>SmallVec</span>::<span class=o>&lt;</span><span class=p>[</span><span class=n>_</span><span class=p>;</span><span class=w> </span><span class=mi>4</span><span class=p>]</span><span class=o>&gt;</span>::<span class=n>with_capacity</span><span class=p>(</span><span class=n>arity</span><span class=p>);</span><span class=w></span>
<a id=__codelineno-23-17 name=__codelineno-23-17></a><span class=w>        </span><span class=k>for</span><span class=w> </span><span class=n>_</span><span class=w> </span><span class=k>in</span><span class=w> </span><span class=mi>0</span><span class=o>..</span><span class=n>arity</span><span class=w> </span><span class=p>{</span><span class=w></span>
<a id=__codelineno-23-18 name=__codelineno-23-18></a><span class=w>            </span><span class=kd>let</span><span class=w> </span><span class=n>vertex</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>arc</span><span class=p>.</span><span class=n>split_at_midpoint</span><span class=p>();</span><span class=w></span>
<a id=__codelineno-23-19 name=__codelineno-23-19></a><span class=w>            </span><span class=n>splits</span><span class=p>.</span><span class=n>push</span><span class=p>(</span><span class=n>vertex</span><span class=p>.</span><span class=n>key</span><span class=p>());</span><span class=w></span>
<a id=__codelineno-23-20 name=__codelineno-23-20></a><span class=w>            </span><span class=n>arc</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>vertex</span><span class=p>.</span><span class=n>into_outgoing_arc</span><span class=p>().</span><span class=n>into_next_arc</span><span class=p>();</span><span class=w></span>
<a id=__codelineno-23-21 name=__codelineno-23-21></a><span class=w>        </span><span class=p>}</span><span class=w></span>
<a id=__codelineno-23-22 name=__codelineno-23-22></a><span class=w>        </span><span class=c1>// Split faces along the vertices from each arc split.</span>
<a id=__codelineno-23-23 name=__codelineno-23-23></a><span class=w>        </span><span class=kd>let</span><span class=w> </span><span class=k>mut</span><span class=w> </span><span class=n>face</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>arc</span><span class=p>.</span><span class=n>into_face</span><span class=p>().</span><span class=n>unwrap</span><span class=p>();</span><span class=w></span>
<a id=__codelineno-23-24 name=__codelineno-23-24></a><span class=w>        </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=n>a</span><span class=p>,</span><span class=w> </span><span class=n>b</span><span class=p>)</span><span class=w> </span><span class=k>in</span><span class=w> </span><span class=n>splits</span><span class=p>.</span><span class=n>into_iter</span><span class=p>().</span><span class=n>perimeter</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w></span>
<a id=__codelineno-23-25 name=__codelineno-23-25></a><span class=w>            </span><span class=n>face</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>face</span><span class=p>.</span><span class=n>split</span><span class=p>(</span><span class=n>ByKey</span><span class=p>(</span><span class=n>a</span><span class=p>),</span><span class=w> </span><span class=n>ByKey</span><span class=p>(</span><span class=n>b</span><span class=p>)).</span><span class=n>unwrap</span><span class=p>().</span><span class=n>into_face</span><span class=p>().</span><span class=n>unwrap</span><span class=p>();</span><span class=w></span>
<a id=__codelineno-23-26 name=__codelineno-23-26></a><span class=w>        </span><span class=p>}</span><span class=w></span>
<a id=__codelineno-23-27 name=__codelineno-23-27></a><span class=w>        </span><span class=c1>// Return the face forming the similar polygon.</span>
<a id=__codelineno-23-28 name=__codelineno-23-28></a><span class=w>        </span><span class=n>face</span><span class=w></span>
<a id=__codelineno-23-29 name=__codelineno-23-29></a><span class=w>    </span><span class=p>}</span><span class=w></span>
<a id=__codelineno-23-30 name=__codelineno-23-30></a><span class=p>}</span><span class=w></span>
</code></pre></div></td></tr></table></div> <p>These traits avoid the need to specify very complex type bounds, but it is also possible to express type bounds directly using traits from the [<code>decorum</code>][] and [<code>theon</code>][] crates.</p> <p>The following example expresses type bounds for a function that computes the area of faces in two-dimensional graphs:</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-24-1>1</a></span>
<span class=normal><a href=#__codelineno-24-2>2</a></span>
<span class=normal><a href=#__codelineno-24-3>3</a></span>
<span class=normal><a href=#__codelineno-24-4>4</a></span>
<span class=normal><a href=#__codelineno-24-5>5</a></span>
<span class=normal><a href=#__codelineno-24-6>6</a></span>
<span class=normal><a href=#__codelineno-24-7>7</a></span>
<span class=normal><a href=#__codelineno-24-8>8</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-24-1 name=__codelineno-24-1></a><span class=k>pub</span><span class=w> </span><span class=k>fn</span> <span class=nf>area</span><span class=o>&lt;</span><span class=n>G</span><span class=o>&gt;</span><span class=p>(</span><span class=n>face</span>: <span class=nc>FaceView</span><span class=o>&lt;&amp;</span><span class=n>MeshGraph</span><span class=o>&lt;</span><span class=n>G</span><span class=o>&gt;&gt;</span><span class=p>)</span><span class=w> </span>-&gt; <span class=nc>Scalar</span><span class=o>&lt;</span><span class=n>VertexPosition</span><span class=o>&lt;</span><span class=n>G</span><span class=o>&gt;&gt;</span><span class=w></span>
<a id=__codelineno-24-2 name=__codelineno-24-2></a><span class=k>where</span><span class=w></span>
<a id=__codelineno-24-3 name=__codelineno-24-3></a><span class=w>    </span><span class=n>G</span>: <span class=nc>GraphData</span><span class=p>,</span><span class=w></span>
<a id=__codelineno-24-4 name=__codelineno-24-4></a><span class=w>    </span><span class=n>G</span>::<span class=n>Vertex</span>: <span class=nc>AsPosition</span><span class=p>,</span><span class=w></span>
<a id=__codelineno-24-5 name=__codelineno-24-5></a><span class=w>    </span><span class=n>VertexPosition</span><span class=o>&lt;</span><span class=n>G</span><span class=o>&gt;</span>: <span class=nc>EuclideanSpace</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>FiniteDimensional</span><span class=o>&lt;</span><span class=n>N</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>U2</span><span class=o>&gt;</span><span class=p>,</span><span class=w></span>
<a id=__codelineno-24-6 name=__codelineno-24-6></a><span class=p>{</span><span class=w></span>
<a id=__codelineno-24-7 name=__codelineno-24-7></a><span class=w>    </span><span class=c1>// ...</span>
<a id=__codelineno-24-8 name=__codelineno-24-8></a><span class=p>}</span><span class=w></span>
</code></pre></div></td></tr></table></div> <p>Some entities and meta-entities are strongly related and have common semantics. These entities and their views can be abstracted via traits. The <code>ToArc</code> trait is implemented by <code>ArcView</code> and <code>EdgeView</code> and allows either type to be converted into an arc that participates in its composite edge. Similarly, the <code>ToRing</code> trait is implemented by <code>FaceView</code> and <code>Ring</code> and allows either type to be converted into its associated ring. Geometric operation traits like <code>EdgeMidpoint</code> use these traits to accept related entities, for example.</p> </article> </div> </div> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../geometry/ class="md-footer__link md-footer__link--prev" aria-label="Previous: Geometry" rel=prev> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </div> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Previous </span> Geometry </div> </div> </a> <a href=../../contributor-guide/tools-and-hosting/ class="md-footer__link md-footer__link--next" aria-label="Next: Tools and Hosting" rel=next> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Next </span> Tools and Hosting </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://github.com/olson-sean-k target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 480 512"><!-- Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg> </a> <a href=https://twitter.com/olsonseank target=_blank rel=noopener title=twitter.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.b97dbffb.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script> <script src=../../assets/javascripts/bundle.6c7ad80a.min.js></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script> </body> </html>